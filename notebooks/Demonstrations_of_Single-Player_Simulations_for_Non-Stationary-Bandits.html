

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38514290-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Table of Contents &mdash; SMPyBandits 0.9.5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A note on execution times, speed and profiling" href="../Profiling.html" />
    <link rel="prev" title="Table of Contents" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> SMPyBandits
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html"><em>SMPyBandits</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/modules.html">SMPyBandits modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../How_to_run_the_code.html">How to run the code ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PublicationsWithSMPyBandits.html">List of research publications using Lilian Bessonâ€™s SMPyBandits project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Aggregation.html"><strong>Policy aggregation algorithms</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../MultiPlayers.html"><strong>Multi-players simulation environment</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../DoublingTrick.html"><strong>Doubling Trick for Multi-Armed Bandits</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../SparseBandits.html"><strong>Structure and Sparsity of Stochastic Multi-Armed Bandits</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../NonStationaryBandits.html"><strong>Non-Stationary Stochastic Multi-Armed Bandits</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">Short documentation of the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TODO.html">ðŸ’¥ TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plots/README.html">Some illustrations for this project</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Jupyter Notebooks ðŸ““ by Naereen &#64; GitHub</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="list.html">List of notebooks for SMPyBandits</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Easily_creating_MAB_problems.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Easily_creating_MAB_problems.html#Easily-creating-MAB-problems">Easily creating MAB problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Do_we_even_need_UCB.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Do_we_even_need_UCB.html#Do-we-even-need-a-smart-learning-algorithm?-Is-UCB-useless?"><em>Do we even need a smart learning algorithm? Is UCB useless?</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_of_a_small_Single-Player_Simulation.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_of_a_small_Single-Player_Simulation.html#An-example-of-a-small-Single-Player-simulation">An example of a small Single-Player simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_of_a_small_Multi-Player_Simulation__with_Centralized_Algorithms.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_of_a_small_Multi-Player_Simulation__with_Centralized_Algorithms.html#An-example-of-a-small-Multi-Player-simulation,-with-Centralized-Algorithms">An example of a small Multi-Player simulation, with Centralized Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_of_a_small_Multi-Player_Simulation__with_rhoRand_and_Selfish_Algorithms.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_of_a_small_Multi-Player_Simulation__with_rhoRand_and_Selfish_Algorithms.html#An-example-of-a-small-Multi-Player-simulation,-with-rhoRand-and-Selfish,-for-different-algorithms">An example of a small Multi-Player simulation, with rhoRand and Selfish, for different algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unsupervised_Learning_for_Bandit_problem.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unsupervised_Learning_for_Bandit_problem.html#Trying-to-use-Unsupervised-Learning-algorithms-for-a-Gaussian-bandit-problem">Trying to use Unsupervised Learning algorithms for a Gaussian bandit problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBox_Bayesian_Optimization_for_Bandit_problems.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBox_Bayesian_Optimization_for_Bandit_problems.html#Trying-to-use-Black-Box-Bayesian-optimization-algorithms-for-a-Gaussian-bandit-problem">Trying to use Black-Box Bayesian optimization algorithms for a Gaussian bandit problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Lai_Robbins_Lower_Bound_for_Doubling_Trick_with_Restarting_Algorithms.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Lai_Robbins_Lower_Bound_for_Doubling_Trick_with_Restarting_Algorithms.html#Lai-&amp;-Robbins-lower-bound-for-stochastic-bandit-with-full-restart-points">Lai &amp; Robbins lower-bound for stochastic bandit with full restart points</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exploring_different_doubling_tricks_for_different_kinds_of_regret_bounds.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exploring_different_doubling_tricks_for_different_kinds_of_regret_bounds.html#Exploring-different-doubling-tricks-for-different-kinds-of-regret-bounds">Exploring different doubling tricks for different kinds of regret bounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html#Requirements-and-helper-functions">Requirements and helper functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html#Python-implementations-of-some-statistical-tests">Python implementations of some statistical tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html#Comparing-the-different-implementations">Comparing the different implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html#More-simulations-and-some-plots">More simulations and some plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html#Exploring-the-parameters-of-change-point-detection-algorithms:-how-to-tune-them?">Exploring the parameters of change point detection algorithms: how to tune them?</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html#Conclusions">Conclusions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Demonstrations-of-Single-Player-Simulations-for-Non-Stationary-Bandits">Demonstrations of Single-Player Simulations for Non-Stationary-Bandits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Creating-the-problem">Creating the problem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Parameters-for-the-simulation">Parameters for the simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Two-MAB-problems-with-Bernoulli-arms-and-piecewise-stationary-means">Two MAB problems with Bernoulli arms and piecewise stationary means</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Some-MAB-algorithms">Some MAB algorithms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Checking-if-the-problems-are-too-hard-or-not">Checking if the problems are too hard or not</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-the-Evaluator-object">Creating the <code class="docutils literal notranslate"><span class="pre">Evaluator</span></code> object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Solving-the-problem">Solving the problem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#First-problem">First problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Second-problem">Second problem</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-the-results">Plotting the results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#First-problem-with-change-on-only-one-arm-(Local-Restart-should-be-better)">First problem with change on only one arm (Local Restart should be better)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Second-problem-with-changes-on-all-arms-(Global-restart-should-be-better)">Second problem with changes on all arms (Global restart should be better)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Profiling.html">A note on execution times, speed and profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uml_diagrams/README.html">UML diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logs/README.html"><code class="docutils literal notranslate"><span class="pre">logs</span></code> files</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SMPyBandits</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="list.html">List of notebooks for SMPyBandits</a> &raquo;</li>
        
      <li>Table of Contents</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Table-of-Contents">
<h1>Table of Contents<a class="headerlink" href="#Table-of-Contents" title="Permalink to this headline">Â¶</a></h1>
<p><div class="lev1 toc-item"><p>1&nbsp;&nbsp;Demonstrations of Single-Player Simulations for Non-Stationary-Bandits</p>
</div><div class="lev2 toc-item"><p>1.1&nbsp;&nbsp;Creating the problem</p>
</div><div class="lev3 toc-item"><p>1.1.1&nbsp;&nbsp;Parameters for the simulation</p>
</div><div class="lev3 toc-item"><p>1.1.2&nbsp;&nbsp;Two MAB problems with Bernoulli arms and piecewise stationary means</p>
</div><div class="lev3 toc-item"><p>1.1.3&nbsp;&nbsp;Some MAB algorithms</p>
</div><div class="lev4 toc-item"><p>1.1.3.1&nbsp;&nbsp;Parameters of the algorithms</p>
</div><div class="lev4 toc-item"><p>1.1.3.2&nbsp;&nbsp;Algorithms</p>
</div><div class="lev2 toc-item"><p>1.2&nbsp;&nbsp;Checking if the problems are too hard or not</p>
</div><div class="lev2 toc-item"><p>1.3&nbsp;&nbsp;Creating the Evaluator object</p>
</div><div class="lev2 toc-item"><p>1.4&nbsp;&nbsp;Solving the problem</p>
</div><div class="lev3 toc-item"><p>1.4.1&nbsp;&nbsp;First problem</p>
</div><div class="lev3 toc-item"><p>1.4.2&nbsp;&nbsp;Second problem</p>
</div><div class="lev2 toc-item"><p>1.5&nbsp;&nbsp;Plotting the results</p>
</div><div class="lev3 toc-item"><p>1.5.1&nbsp;&nbsp;First problem with change on only one arm (Local Restart should be better)</p>
</div><div class="lev3 toc-item"><p>1.5.2&nbsp;&nbsp;Second problem with changes on all arms (Global restart should be better)</p>
</div></div>
<hr class="docutils" />
<div class="section" id="Demonstrations-of-Single-Player-Simulations-for-Non-Stationary-Bandits">
<h1>Demonstrations of Single-Player Simulations for Non-Stationary-Bandits<a class="headerlink" href="#Demonstrations-of-Single-Player-Simulations-for-Non-Stationary-Bandits" title="Permalink to this headline">Â¶</a></h1>
<p>This notebook shows how to 1) <strong>define</strong>, 2) <strong>launch</strong>, and 3) <strong>plot the results</strong> of numerical simulations of piecewise stationary (multi-armed) bandits problems using my framework <a class="reference external" href="https://github.com/SMPyBandits/SMPyBandits">SMPyBandits</a>. For more details on the maths behind this problem, see this page in the documentation: <a class="reference external" href="https://smpybandits.github.io/NonStationaryBandits.html">SMPyBandits.GitHub.io/NonStationaryBandits.html</a>.</p>
<p>First, be sure to be in the main folder, or to have <a class="reference external" href="https://github.com/SMPyBandits/SMPyBandits">SMPyBandits</a> installed, and import <code class="docutils literal notranslate"><span class="pre">Evaluator</span></code> from <code class="docutils literal notranslate"><span class="pre">Environment</span></code> package.</p>
<p>WARNING If you are running this notebook locally, in the <code class="docutils literal notranslate"><span class="pre">`notebooks</span></code> &lt;<a class="reference external" href="https://github.com/SMPyBandits/SMPyBandits/tree/master/notebooks">https://github.com/SMPyBandits/SMPyBandits/tree/master/notebooks</a>&gt;`__ folder in the <code class="docutils literal notranslate"><span class="pre">`SMPyBandits</span></code> &lt;<a class="reference external" href="https://github.com/SMPyBandits/SMPyBandits/">https://github.com/SMPyBandits/SMPyBandits/</a>&gt;`__ source, you need to do:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you are running this notebook elsewhere, <code class="docutils literal notranslate"><span class="pre">SMPyBandits</span></code> can be <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code>ed easily: (this is especially true if you run this notebook from Google Colab or MyBinder).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">SMPyBandits</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="o">!</span>pip3 install SMPyBandits
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Info: Using the Jupyter notebook version of the tqdm() decorator, tqdm_notebook() ...
</pre></div></div>
</div>
<p>Letâ€™s just check the versions of the installed modules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>pip3 install watermark &gt; /dev/null
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -v -m -p SMPyBandits,numpy,matplotlib -a &quot;Lilian Besson&quot;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Lilian Besson

CPython 3.6.7
IPython 7.2.0

SMPyBandits 0.9.4
numpy 1.15.4
matplotlib 3.0.2

compiler   : GCC 8.2.0
system     : Linux
release    : 4.15.0-42-generic
machine    : x86_64
processor  : x86_64
CPU cores  : 4
interpreter: 64bit
</pre></div></div>
</div>
<p>We can now import all the modules we need for this demonstration.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FIGSIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mf">19.80</span><span class="p">,</span> <span class="mf">10.80</span><span class="p">)</span>
<span class="n">DPI</span> <span class="o">=</span> <span class="mi">160</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Large figures for pretty notebooks</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FIGSIZE</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DPI</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Local imports</span>
<span class="kn">from</span> <span class="nn">SMPyBandits.Environment</span> <span class="k">import</span> <span class="n">Evaluator</span><span class="p">,</span> <span class="n">tqdm</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Large figures for pretty notebooks</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FIGSIZE</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DPI</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Large figures for pretty notebooks</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FIGSIZE</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DPI</span>
</pre></div>
</div>
</div>
<p>We also need arms, for instance <code class="docutils literal notranslate"><span class="pre">Bernoulli</span></code>-distributed arm:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import arms</span>
<span class="kn">from</span> <span class="nn">SMPyBandits.Arms</span> <span class="k">import</span> <span class="n">Bernoulli</span>
</pre></div>
</div>
</div>
<p>And finally we need some single-player Reinforcement Learning algorithms:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import algorithms</span>
<span class="kn">from</span> <span class="nn">SMPyBandits.Policies</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Creating-the-problem">
<h2>Creating the problem<a class="headerlink" href="#Creating-the-problem" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="Parameters-for-the-simulation">
<h3>Parameters for the simulation<a class="headerlink" href="#Parameters-for-the-simulation" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(T = 2000\)</span> is the time horizon,</li>
<li><span class="math notranslate nohighlight">\(N = 100\)</span> is the number of repetitions, or 1 to debug the simulations,</li>
<li><code class="docutils literal notranslate"><span class="pre">N_JOBS</span> <span class="pre">=</span> <span class="pre">4</span></code> is the number of cores used to parallelize the code,</li>
<li><span class="math notranslate nohighlight">\(5\)</span> piecewise stationary sequences will have length 400</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">cpu_count</span>
<span class="n">CPU_COUNT</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span>
<span class="n">N_JOBS</span> <span class="o">=</span> <span class="n">CPU_COUNT</span> <span class="k">if</span> <span class="n">CPU_COUNT</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="k">else</span> <span class="n">CPU_COUNT</span> <span class="o">-</span> <span class="mi">4</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using </span><span class="si">{}</span><span class="s2"> jobs in parallel...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N_JOBS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using 4 jobs in parallel...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">HORIZON</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">REPETITIONS</span> <span class="o">=</span> <span class="mi">50</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using T = </span><span class="si">{}</span><span class="s2">, and N = </span><span class="si">{}</span><span class="s2"> repetitions&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HORIZON</span><span class="p">,</span> <span class="n">REPETITIONS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using T = 2000, and N = 50 repetitions
</pre></div></div>
</div>
</div>
<div class="section" id="Two-MAB-problems-with-Bernoulli-arms-and-piecewise-stationary-means">
<h3>Two MAB problems with Bernoulli arms and piecewise stationary means<a class="headerlink" href="#Two-MAB-problems-with-Bernoulli-arms-and-piecewise-stationary-means" title="Permalink to this headline">Â¶</a></h3>
<p>We consider in this example <span class="math notranslate nohighlight">\(2\)</span> problems, with <code class="docutils literal notranslate"><span class="pre">Bernoulli</span></code> arms, of different piecewise stationary means.</p>
<ol class="arabic simple">
<li>The first problem has changes on only one arm at every breakpoint times,</li>
<li>The second problem has changes on all arms at every breakpoint times.</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ENVIRONMENTS</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ENVIRONMENT_0</span> <span class="o">=</span> <span class="p">{</span>   <span class="c1"># A simple piece-wise stationary problem</span>
    <span class="s2">&quot;arm_type&quot;</span><span class="p">:</span> <span class="n">Bernoulli</span><span class="p">,</span>
    <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;listOfMeans&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>  <span class="c1"># 0    to 399</span>
            <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>  <span class="c1"># 400  to 799</span>
            <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>  <span class="c1"># 800  to 1199</span>
            <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>  <span class="c1"># 1200 to 1599</span>
            <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>  <span class="c1"># 1600 to end</span>
        <span class="p">],</span>
        <span class="s2">&quot;changePoints&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">0</span>    <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">400</span>  <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">800</span>  <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">1200</span> <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">1600</span> <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Pb 2 changes are on all or almost arms at a time</span>
<span class="n">ENVIRONMENT_1</span> <span class="o">=</span>  <span class="p">{</span>   <span class="c1"># A simple piece-wise stationary problem</span>
    <span class="s2">&quot;arm_type&quot;</span><span class="p">:</span> <span class="n">Bernoulli</span><span class="p">,</span>
    <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;listOfMeans&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>  <span class="c1"># 0    to 399</span>
            <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>  <span class="c1"># 400  to 799</span>
            <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>  <span class="c1"># 800  to 1199</span>
            <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>  <span class="c1"># 1200 to 1599</span>
            <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>  <span class="c1"># 1600 to end</span>
        <span class="p">],</span>
        <span class="s2">&quot;changePoints&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">0</span>    <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">400</span>  <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">800</span>  <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">1200</span> <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
            <span class="nb">int</span><span class="p">(</span><span class="mi">1600</span> <span class="o">*</span> <span class="n">HORIZON</span> <span class="o">/</span> <span class="mf">2000.0</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ENVIRONMENTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ENVIRONMENT_0</span><span class="p">,</span>
    <span class="n">ENVIRONMENT_1</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">list_nb_arms</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="s2">&quot;listOfMeans&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">env</span> <span class="ow">in</span> <span class="n">ENVIRONMENTS</span><span class="p">]</span>
<span class="n">NB_ARMS</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">list_nb_arms</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">NB_ARMS</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">list_nb_arms</span><span class="p">),</span> <span class="s2">&quot;Error: it is NOT supported to have successive problems with a different number of arms!&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==&gt; Using K = </span><span class="si">{}</span><span class="s2"> arms&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NB_ARMS</span><span class="p">))</span>

<span class="n">NB_BREAK_POINTS</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="s2">&quot;changePoints&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">env</span> <span class="ow">in</span> <span class="n">ENVIRONMENTS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==&gt; Using Upsilon_T = </span><span class="si">{}</span><span class="s2"> change points&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NB_BREAK_POINTS</span><span class="p">))</span>

<span class="n">CHANGE_POINTS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="s2">&quot;changePoints&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">env</span> <span class="ow">in</span> <span class="n">ENVIRONMENTS</span><span class="p">)))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==&gt; Using the following </span><span class="si">{}</span><span class="s2"> change points&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">CHANGE_POINTS</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==&gt; Using K = 3 arms
==&gt; Using Upsilon_T = 5 change points
==&gt; Using the following [0, 400, 800, 1200, 1600] change points
</pre></div></div>
</div>
</div>
<div class="section" id="Some-MAB-algorithms">
<h3>Some MAB algorithms<a class="headerlink" href="#Some-MAB-algorithms" title="Permalink to this headline">Â¶</a></h3>
<p>We want compare some classical MAB algorithms (<span class="math notranslate nohighlight">\(\mathrm{UCB}_1\)</span>, Thompson Sampling and <span class="math notranslate nohighlight">\(\mathrm{kl}\)</span>-<span class="math notranslate nohighlight">\(\mathrm{UCB}\)</span>) that are designed to solve stationary problems against other algorithms designed to solve piecewise-stationary problems.</p>
<div class="section" id="Parameters-of-the-algorithms">
<h4>Parameters of the algorithms<a class="headerlink" href="#Parameters-of-the-algorithms" title="Permalink to this headline">Â¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">klucb</span> <span class="o">=</span> <span class="n">klucb_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ENVIRONMENTS</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;arm_type&#39;</span><span class="p">]),</span> <span class="n">klucbBern</span><span class="p">)</span>
<span class="n">klucb</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;function SMPyBandits.Policies.kullback.klucbBern&gt;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">WINDOW_SIZE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">80</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">HORIZON</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;M-UCB will use a window of size </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WINDOW_SIZE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M-UCB will use a window of size 80
</pre></div></div>
</div>
</div>
<div class="section" id="Algorithms">
<h4>Algorithms<a class="headerlink" href="#Algorithms" title="Permalink to this headline">Â¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">POLICIES</span> <span class="o">=</span> <span class="p">[</span>  <span class="c1"># XXX Regular adversarial bandits algorithms!</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">Exp3PlusPlus</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}</span> <span class="p">},</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># XXX Regular stochastic bandits algorithms!</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">UCBalpha</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="p">}</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">klUCB</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;klucb&quot;</span><span class="p">:</span> <span class="n">klucb</span><span class="p">,</span> <span class="p">}</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">Thompson</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;posterior&quot;</span><span class="p">:</span> <span class="n">Beta</span><span class="p">,</span> <span class="p">}</span> <span class="p">},</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># XXX This is still highly experimental!</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">DiscountedThompson</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;posterior&quot;</span><span class="p">:</span> <span class="n">DiscountedBeta</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># --- The Exp3R algorithm works reasonably well</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">Exp3R</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># --- XXX The Exp3RPlusPlus variant of Exp3R algorithm works also reasonably well</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">Exp3RPlusPlus</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># --- XXX Test a few CD-MAB algorithms that need to know NB_BREAK_POINTS</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">archtype</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span>
            <span class="s2">&quot;max_nb_random_events&quot;</span><span class="p">:</span> <span class="n">NB_BREAK_POINTS</span><span class="p">,</span>
            <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="p">,</span>
            <span class="s2">&quot;per_arm_restart&quot;</span><span class="p">:</span> <span class="n">per_arm_restart</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">archtype</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">CUSUM_IndexPolicy</span><span class="p">,</span>
            <span class="n">PHT_IndexPolicy</span><span class="p">,</span>  <span class="c1"># OK PHT_IndexPolicy is very much like CUSUM</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">policy</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="c1"># UCB,  # XXX comment to only test klUCB</span>
            <span class="n">klUCB</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">per_arm_restart</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Per-arm restart XXX comment to only test global arm</span>
            <span class="kc">False</span><span class="p">,</span> <span class="c1"># Global restart XXX seems more efficient? (at least more memory efficient!)</span>
        <span class="p">]</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># --- XXX Test a few CD-MAB algorithms</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">archtype</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span>
            <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="p">,</span>
            <span class="s2">&quot;per_arm_restart&quot;</span><span class="p">:</span> <span class="n">per_arm_restart</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">archtype</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">BernoulliGLR_IndexPolicy</span><span class="p">,</span>  <span class="c1"># OK BernoulliGLR_IndexPolicy is very much like CUSUM</span>
            <span class="n">GaussianGLR_IndexPolicy</span><span class="p">,</span>  <span class="c1"># OK GaussianGLR_IndexPolicy is very much like Bernoulli GLR</span>
            <span class="n">SubGaussianGLR_IndexPolicy</span><span class="p">,</span> <span class="c1"># OK SubGaussianGLR_IndexPolicy is very much like Gaussian GLR</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">policy</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="c1"># UCB,  # XXX comment to only test klUCB</span>
            <span class="n">klUCB</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">per_arm_restart</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Per-arm restart XXX comment to only test global arm</span>
            <span class="kc">False</span><span class="p">,</span> <span class="c1"># Global restart XXX seems more efficient? (at least more memory efficient!)</span>
        <span class="p">]</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># --- XXX The Monitored_IndexPolicy with specific tuning of the input parameters</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">Monitored_IndexPolicy</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span>
            <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">WINDOW_SIZE</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">WINDOW_SIZE</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">NB_ARMS</span> <span class="o">*</span> <span class="n">HORIZON</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
            <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="p">,</span>
            <span class="s2">&quot;per_arm_restart&quot;</span><span class="p">:</span> <span class="n">per_arm_restart</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">policy</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="c1"># UCB,</span>
            <span class="n">klUCB</span><span class="p">,</span>  <span class="c1"># XXX comment to only test UCB</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">per_arm_restart</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Per-arm restart XXX comment to only test global arm</span>
            <span class="kc">False</span><span class="p">,</span> <span class="c1"># Global restart XXX seems more efficient? (at least more memory efficient!)</span>
        <span class="p">]</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># --- DONE The SW_UCB_Hash algorithm works fine!</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">SWHash_IndexPolicy</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span> <span class="s2">&quot;lmbda&quot;</span><span class="p">:</span> <span class="n">lmbda</span><span class="p">,</span> <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="n">UCB</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">lmbda</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span> <span class="c1"># --- # XXX experimental other version of the sliding window algorithm, knowing the horizon</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">SWUCBPlus</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span> <span class="c1"># --- # XXX experimental discounted UCB algorithm, knowing the horizon</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">DiscountedUCBPlus</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;max_nb_random_events&quot;</span><span class="p">:</span> <span class="n">max_nb_random_events</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span> <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">max_nb_random_events</span> <span class="ow">in</span> <span class="p">[</span><span class="n">NB_BREAK_POINTS</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span>  <span class="c1"># --- DONE the OracleSequentiallyRestartPolicy with klUCB/UCB policy works quite well, but NOT optimally!</span>
        <span class="p">{</span> <span class="s2">&quot;archtype&quot;</span><span class="p">:</span> <span class="n">OracleSequentiallyRestartPolicy</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;changePoints&quot;</span><span class="p">:</span> <span class="n">CHANGE_POINTS</span><span class="p">,</span> <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="p">,</span>
            <span class="s2">&quot;per_arm_restart&quot;</span><span class="p">:</span> <span class="n">per_arm_restart</span><span class="p">,</span>
            <span class="c1"># &quot;full_restart_when_refresh&quot;: full_restart_when_refresh,</span>
        <span class="p">}</span> <span class="p">}</span>
        <span class="k">for</span> <span class="n">policy</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">UCB</span><span class="p">,</span>
            <span class="n">klUCB</span><span class="p">,</span>  <span class="c1"># XXX comment to only test UCB</span>
            <span class="n">Exp3PlusPlus</span><span class="p">,</span>  <span class="c1"># XXX comment to only test UCB</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">per_arm_restart</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>  <span class="c1">#, False]</span>
        <span class="c1"># for full_restart_when_refresh in [True, False]</span>
    <span class="p">]</span>
</pre></div>
</div>
</div>
<p>The complete configuration for the problems and these algorithms is then a simple dictionary:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">configuration</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># --- Duration of the experiment</span>
    <span class="s2">&quot;horizon&quot;</span><span class="p">:</span> <span class="n">HORIZON</span><span class="p">,</span>
    <span class="c1"># --- Number of repetition of the experiment (to have an average)</span>
    <span class="s2">&quot;repetitions&quot;</span><span class="p">:</span> <span class="n">REPETITIONS</span><span class="p">,</span>
    <span class="c1"># --- Parameters for the use of joblib.Parallel</span>
    <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span> <span class="n">N_JOBS</span><span class="p">,</span>    <span class="c1"># = nb of CPU cores</span>
    <span class="s2">&quot;verbosity&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>      <span class="c1"># Max joblib verbosity</span>
    <span class="c1"># --- Arms</span>
    <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">ENVIRONMENTS</span><span class="p">,</span>
    <span class="c1"># --- Algorithms</span>
    <span class="s2">&quot;policies&quot;</span><span class="p">:</span> <span class="n">POLICIES</span><span class="p">,</span>
    <span class="c1"># --- Random events</span>
    <span class="s2">&quot;nb_break_points&quot;</span><span class="p">:</span> <span class="n">NB_BREAK_POINTS</span><span class="p">,</span>
    <span class="c1"># --- Should we plot the lower-bounds or not?</span>
    <span class="s2">&quot;plot_lowerbound&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># XXX Default</span>
<span class="p">}</span>

<span class="n">configuration</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{&#39;horizon&#39;: 2000,
 &#39;repetitions&#39;: 50,
 &#39;n_jobs&#39;: 4,
 &#39;verbosity&#39;: 0,
 &#39;environment&#39;: [{&#39;arm_type&#39;: SMPyBandits.Arms.Bernoulli.Bernoulli,
   &#39;params&#39;: {&#39;listOfMeans&#39;: [[0.2, 0.5, 0.9],
     [0.2, 0.2, 0.9],
     [0.2, 0.2, 0.1],
     [0.7, 0.2, 0.1],
     [0.7, 0.5, 0.1]],
    &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}},
  {&#39;arm_type&#39;: SMPyBandits.Arms.Bernoulli.Bernoulli,
   &#39;params&#39;: {&#39;listOfMeans&#39;: [[0.4, 0.5, 0.9],
     [0.5, 0.4, 0.7],
     [0.6, 0.3, 0.5],
     [0.7, 0.2, 0.3],
     [0.8, 0.1, 0.1]],
    &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}}],
 &#39;policies&#39;: [{&#39;archtype&#39;: SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus,
   &#39;params&#39;: {}},
  {&#39;archtype&#39;: SMPyBandits.Policies.UCBalpha.UCBalpha, &#39;params&#39;: {&#39;alpha&#39;: 1}},
  {&#39;archtype&#39;: SMPyBandits.Policies.klUCB.klUCB,
   &#39;params&#39;: {&#39;klucb&#39;: &lt;function SMPyBandits.Policies.kullback.klucbBern&gt;}},
  {&#39;archtype&#39;: SMPyBandits.Policies.Thompson.Thompson,
   &#39;params&#39;: {&#39;posterior&#39;: SMPyBandits.Policies.Posterior.Beta.Beta}},
  {&#39;archtype&#39;: SMPyBandits.Policies.DiscountedThompson.DiscountedThompson,
   &#39;params&#39;: {&#39;posterior&#39;: SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta,
    &#39;gamma&#39;: 0.99}},
  {&#39;archtype&#39;: SMPyBandits.Policies.DiscountedThompson.DiscountedThompson,
   &#39;params&#39;: {&#39;posterior&#39;: SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta,
    &#39;gamma&#39;: 0.9}},
  {&#39;archtype&#39;: SMPyBandits.Policies.DiscountedThompson.DiscountedThompson,
   &#39;params&#39;: {&#39;posterior&#39;: SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta,
    &#39;gamma&#39;: 0.7}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.Exp3R, &#39;params&#39;: {&#39;horizon&#39;: 2000}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.Exp3RPlusPlus,
   &#39;params&#39;: {&#39;horizon&#39;: 2000}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;max_nb_random_events&#39;: 5,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;max_nb_random_events&#39;: 5,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: False}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;max_nb_random_events&#39;: 5,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;max_nb_random_events&#39;: 5,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: False}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: False}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: False}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: False}},
  {&#39;archtype&#39;: SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;w&#39;: 80,
    &#39;b&#39;: 26.07187326473663,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy,
   &#39;params&#39;: {&#39;horizon&#39;: 2000,
    &#39;w&#39;: 80,
    &#39;b&#39;: 26.07187326473663,
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: False}},
  {&#39;archtype&#39;: SMPyBandits.Policies.SWHash_UCB.SWHash_IndexPolicy,
   &#39;params&#39;: {&#39;alpha&#39;: 1.0,
    &#39;lmbda&#39;: 1,
    &#39;policy&#39;: SMPyBandits.Policies.UCB.UCB}},
  {&#39;archtype&#39;: SMPyBandits.Policies.SlidingWindowUCB.SWUCBPlus,
   &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;alpha&#39;: 1.0}},
  {&#39;archtype&#39;: SMPyBandits.Policies.DiscountedUCB.DiscountedUCBPlus,
   &#39;params&#39;: {&#39;max_nb_random_events&#39;: 5, &#39;alpha&#39;: 1.0, &#39;horizon&#39;: 2000}},
  {&#39;archtype&#39;: SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy,
   &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]),
    &#39;policy&#39;: SMPyBandits.Policies.UCB.UCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy,
   &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]),
    &#39;policy&#39;: SMPyBandits.Policies.klUCB.klUCB,
    &#39;per_arm_restart&#39;: True}},
  {&#39;archtype&#39;: SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy,
   &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]),
    &#39;policy&#39;: SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus,
    &#39;per_arm_restart&#39;: True}}],
 &#39;nb_break_points&#39;: 5,
 &#39;plot_lowerbound&#39;: False}
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># (almost) unique hash from the configuration</span>
<span class="n">hashvalue</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">hash</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">configuration</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">tuple</span><span class="p">([(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="k">else</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">configuration</span><span class="o">.</span><span class="n">values</span><span class="p">()]))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This configuration has a hash value = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hashvalue</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
This configuration has a hash value = 427944937445357777
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">os.path</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">subfolder</span> <span class="o">=</span> <span class="s2">&quot;SP__K</span><span class="si">{}</span><span class="s2">_T</span><span class="si">{}</span><span class="s2">_N</span><span class="si">{}</span><span class="s2">__</span><span class="si">{}</span><span class="s2">_algos&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NB_ARMS</span><span class="p">,</span> <span class="n">HORIZON</span><span class="p">,</span> <span class="n">REPETITIONS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">POLICIES</span><span class="p">))</span>
<span class="n">PLOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;plots&quot;</span>
<span class="n">plot_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PLOT_DIR</span><span class="p">,</span> <span class="n">subfolder</span><span class="p">)</span>

<span class="c1"># Create the sub folder</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is already a directory here...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">))</span>
<span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;[ERROR] </span><span class="si">{}</span><span class="s2"> is a file, cannot use it as a directory !&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using sub folder = &#39;</span><span class="si">{}</span><span class="s2">&#39; and plotting in &#39;</span><span class="si">{}</span><span class="s2">&#39;...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subfolder</span><span class="p">,</span> <span class="n">plot_dir</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using sub folder = &#39;SP__K3_T2000_N50__27_algos&#39; and plotting in &#39;plots/SP__K3_T2000_N50__27_algos&#39;...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mainfig</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">,</span> <span class="s2">&quot;main&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using main figure name as &#39;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&#39;...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">hashvalue</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using main figure name as &#39;plots/SP__K3_T2000_N50__27_algos/main_427944937445357777&#39;...
</pre></div></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Checking-if-the-problems-are-too-hard-or-not">
<h2>Checking if the problems are too hard or not<a class="headerlink" href="#Checking-if-the-problems-are-too-hard-or-not" title="Permalink to this headline">Â¶</a></h2>
<p>If we assume we have a result that bounds the delay of the Change-Detection algorithm by a certain quantity <span class="math notranslate nohighlight">\(D\)</span>, we can check that the sequence lengths (ie, <span class="math notranslate nohighlight">\(\tau_{m+1}-\tau_m\)</span>) are <em>large</em> enough for the CD-klUCB algorithm (our proposal) to be efficient.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">lowerbound_on_sequence_length</span><span class="p">(</span><span class="n">horizon</span><span class="p">,</span> <span class="n">gap</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot; A function that computes the lower-bound (we will find) on the sequence length to have a reasonable bound on the delay of our change-detection algorithm.</span>

<span class="sd">    - It returns the smallest possible sequence length :math:`L = \tau_{m+1} - \tau_m` satisfying:</span>

<span class="sd">    .. math:: L \geq \frac{8}{\Delta^2} \log(T).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">gap</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="k">return</span> <span class="mi">0</span>
    <span class="n">condition</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">length</span><span class="p">:</span> <span class="n">length</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="n">gap</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">length</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">length</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">check_condition_on_piecewise_stationary_problems</span><span class="p">(</span><span class="n">horizon</span><span class="p">,</span> <span class="n">listOfMeans</span><span class="p">,</span> <span class="n">changePoints</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check some conditions on the piecewise stationary problem.&quot;&quot;&quot;</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listOfMeans</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For a piecewise stationary problem with M = </span><span class="si">{}</span><span class="s2"> sequences...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>  <span class="c1"># DEBUG</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">mus_m</span> <span class="o">=</span> <span class="n">listOfMeans</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
        <span class="n">tau_m</span> <span class="o">=</span> <span class="n">changePoints</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
        <span class="n">mus_mp1</span> <span class="o">=</span> <span class="n">listOfMeans</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tau_mp1</span> <span class="o">=</span> <span class="n">changePoints</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Checking m-th (m = </span><span class="si">{}</span><span class="s2">) sequence, Âµ_m = </span><span class="si">{}</span><span class="s2">, Âµ_m+1 = </span><span class="si">{}</span><span class="s2"> and tau_m = </span><span class="si">{}</span><span class="s2"> and tau_m+1 = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">mus_m</span><span class="p">,</span> <span class="n">mus_mp1</span><span class="p">,</span> <span class="n">tau_m</span><span class="p">,</span> <span class="n">tau_mp1</span><span class="p">))</span>  <span class="c1"># DEBUG</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">mu_i_m</span><span class="p">,</span> <span class="n">mu_i_mp1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mus_m</span><span class="p">,</span> <span class="n">mus_mp1</span><span class="p">)):</span>
            <span class="n">gap</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mu_i_m</span> <span class="o">-</span> <span class="n">mu_i_mp1</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">tau_mp1</span> <span class="o">-</span> <span class="n">tau_m</span>
            <span class="n">lowerbound</span> <span class="o">=</span> <span class="n">lowerbound_on_sequence_length</span><span class="p">(</span><span class="n">horizon</span><span class="p">,</span> <span class="n">gap</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - For arm i = </span><span class="si">{}</span><span class="s2">, gap = </span><span class="si">{:.3g}</span><span class="s2"> and length = </span><span class="si">{}</span><span class="s2"> with lowerbound on length = </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">lowerbound</span><span class="p">))</span>  <span class="c1"># DEBUG</span>
            <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">lowerbound</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING For arm i = </span><span class="si">{}</span><span class="s2">, gap = </span><span class="si">{:.3g}</span><span class="s2"> and length = </span><span class="si">{}</span><span class="s2"> &lt; lowerbound on length = </span><span class="si">{}</span><span class="s2"> !!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">lowerbound</span><span class="p">))</span>  <span class="c1"># DEBUG</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">envId</span><span class="p">,</span> <span class="n">env</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">configuration</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n\n</span><span class="s2">Checking environment number </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">envId</span><span class="p">))</span>  <span class="c1"># DEBUG</span>
    <span class="n">listOfMeans</span> <span class="o">=</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="s2">&quot;listOfMeans&quot;</span><span class="p">]</span>
    <span class="n">changePoints</span> <span class="o">=</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">][</span><span class="s2">&quot;changePoints&quot;</span><span class="p">]</span>
    <span class="n">check_condition_on_piecewise_stationary_problems</span><span class="p">(</span><span class="n">HORIZON</span><span class="p">,</span> <span class="n">listOfMeans</span><span class="p">,</span> <span class="n">changePoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>



Checking environment number 0
For a piecewise stationary problem with M = 5 sequences...

Checking m-th (m = 0) sequence, Âµ_m = [0.2, 0.5, 0.9], Âµ_m+1 = [0.2, 0.2, 0.9] and tau_m = 0 and tau_m+1 = 400
   - For arm i = 0, gap = 0 and length = 400 with lowerbound on length = 0...
   - For arm i = 1, gap = 0.3 and length = 400 with lowerbound on length = 676...
WARNING For arm i = 1, gap = 0.3 and length = 400 &lt; lowerbound on length = 676 !!
   - For arm i = 2, gap = 0 and length = 400 with lowerbound on length = 0...

Checking m-th (m = 1) sequence, Âµ_m = [0.2, 0.2, 0.9], Âµ_m+1 = [0.2, 0.2, 0.1] and tau_m = 400 and tau_m+1 = 800
   - For arm i = 0, gap = 0 and length = 400 with lowerbound on length = 0...
   - For arm i = 1, gap = 0 and length = 400 with lowerbound on length = 0...
   - For arm i = 2, gap = 0.8 and length = 400 with lowerbound on length = 96...

Checking m-th (m = 2) sequence, Âµ_m = [0.2, 0.2, 0.1], Âµ_m+1 = [0.7, 0.2, 0.1] and tau_m = 800 and tau_m+1 = 1200
   - For arm i = 0, gap = 0.5 and length = 400 with lowerbound on length = 244...
   - For arm i = 1, gap = 0 and length = 400 with lowerbound on length = 0...
   - For arm i = 2, gap = 0 and length = 400 with lowerbound on length = 0...

Checking m-th (m = 3) sequence, Âµ_m = [0.7, 0.2, 0.1], Âµ_m+1 = [0.7, 0.5, 0.1] and tau_m = 1200 and tau_m+1 = 1600
   - For arm i = 0, gap = 0 and length = 400 with lowerbound on length = 0...
   - For arm i = 1, gap = 0.3 and length = 400 with lowerbound on length = 676...
WARNING For arm i = 1, gap = 0.3 and length = 400 &lt; lowerbound on length = 676 !!
   - For arm i = 2, gap = 0 and length = 400 with lowerbound on length = 0...



Checking environment number 1
For a piecewise stationary problem with M = 5 sequences...

Checking m-th (m = 0) sequence, Âµ_m = [0.4, 0.5, 0.9], Âµ_m+1 = [0.5, 0.4, 0.7] and tau_m = 0 and tau_m+1 = 400
   - For arm i = 0, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 0, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 1, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 1, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 2, gap = 0.2 and length = 400 with lowerbound on length = 1521...
WARNING For arm i = 2, gap = 0.2 and length = 400 &lt; lowerbound on length = 1521 !!

Checking m-th (m = 1) sequence, Âµ_m = [0.5, 0.4, 0.7], Âµ_m+1 = [0.6, 0.3, 0.5] and tau_m = 400 and tau_m+1 = 800
   - For arm i = 0, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 0, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 1, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 1, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 2, gap = 0.2 and length = 400 with lowerbound on length = 1521...
WARNING For arm i = 2, gap = 0.2 and length = 400 &lt; lowerbound on length = 1521 !!

Checking m-th (m = 2) sequence, Âµ_m = [0.6, 0.3, 0.5], Âµ_m+1 = [0.7, 0.2, 0.3] and tau_m = 800 and tau_m+1 = 1200
   - For arm i = 0, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 0, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 1, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 1, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 2, gap = 0.2 and length = 400 with lowerbound on length = 1521...
WARNING For arm i = 2, gap = 0.2 and length = 400 &lt; lowerbound on length = 1521 !!

Checking m-th (m = 3) sequence, Âµ_m = [0.7, 0.2, 0.3], Âµ_m+1 = [0.8, 0.1, 0.1] and tau_m = 1200 and tau_m+1 = 1600
   - For arm i = 0, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 0, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 1, gap = 0.1 and length = 400 with lowerbound on length = 6081...
WARNING For arm i = 1, gap = 0.1 and length = 400 &lt; lowerbound on length = 6081 !!
   - For arm i = 2, gap = 0.2 and length = 400 with lowerbound on length = 1521...
WARNING For arm i = 2, gap = 0.2 and length = 400 &lt; lowerbound on length = 1521 !!
</pre></div></div>
</div>
<p>We checked that the two problems are not â€œeasy enoughâ€ for our approach to be provably efficient.</p>
</div>
<hr class="docutils" />
<div class="section" id="Creating-the-Evaluator-object">
<h2>Creating the <code class="docutils literal notranslate"><span class="pre">Evaluator</span></code> object<a class="headerlink" href="#Creating-the-Evaluator-object" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of policies in this comparison: 27
Time horizon: 2000
Number of repetitions: 50
Sampling rate for plotting, delta_t_plot: 1
Number of jobs for parallelization: 4
Using this dictionary to create a new environment:
 {&#39;arm_type&#39;: &lt;class &#39;SMPyBandits.Arms.Bernoulli.Bernoulli&#39;&gt;, &#39;params&#39;: {&#39;listOfMeans&#39;: [[0.2, 0.5, 0.9], [0.2, 0.2, 0.9], [0.2, 0.2, 0.1], [0.7, 0.2, 0.1], [0.7, 0.5, 0.1]], &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}}
  Special MAB problem, with arm (possibly) changing at every time step, read from a dictionnary &#39;configuration&#39; = {&#39;arm_type&#39;: &lt;class &#39;SMPyBandits.Arms.Bernoulli.Bernoulli&#39;&gt;, &#39;params&#39;: {&#39;listOfMeans&#39;: [[0.2, 0.5, 0.9], [0.2, 0.2, 0.9], [0.2, 0.2, 0.1], [0.7, 0.2, 0.1], [0.7, 0.5, 0.1]], &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}} ...
 - with &#39;arm_type&#39; = &lt;class &#39;SMPyBandits.Arms.Bernoulli.Bernoulli&#39;&gt;
 - with &#39;params&#39; = {&#39;listOfMeans&#39;: [[0.2, 0.5, 0.9], [0.2, 0.2, 0.9], [0.2, 0.2, 0.1], [0.7, 0.2, 0.1], [0.7, 0.5, 0.1]], &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}
 - with &#39;listOfMeans&#39; = [[0.2 0.5 0.9]
 [0.2 0.2 0.9]
 [0.2 0.2 0.1]
 [0.7 0.2 0.1]
 [0.7 0.5 0.1]]
 - with &#39;changePoints&#39; = [0, 400, 800, 1200, 1600]


 ==&gt; Creating the dynamic arms ...
   - with &#39;nbArms&#39; = 3
   - with &#39;arms&#39; = [B(0.2), B(0.5), B(0.9)]
 - Initial draw of &#39;means&#39; = [0.2 0.5 0.9]
Using this dictionary to create a new environment:
 {&#39;arm_type&#39;: &lt;class &#39;SMPyBandits.Arms.Bernoulli.Bernoulli&#39;&gt;, &#39;params&#39;: {&#39;listOfMeans&#39;: [[0.4, 0.5, 0.9], [0.5, 0.4, 0.7], [0.6, 0.3, 0.5], [0.7, 0.2, 0.3], [0.8, 0.1, 0.1]], &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}}
  Special MAB problem, with arm (possibly) changing at every time step, read from a dictionnary &#39;configuration&#39; = {&#39;arm_type&#39;: &lt;class &#39;SMPyBandits.Arms.Bernoulli.Bernoulli&#39;&gt;, &#39;params&#39;: {&#39;listOfMeans&#39;: [[0.4, 0.5, 0.9], [0.5, 0.4, 0.7], [0.6, 0.3, 0.5], [0.7, 0.2, 0.3], [0.8, 0.1, 0.1]], &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}} ...
 - with &#39;arm_type&#39; = &lt;class &#39;SMPyBandits.Arms.Bernoulli.Bernoulli&#39;&gt;
 - with &#39;params&#39; = {&#39;listOfMeans&#39;: [[0.4, 0.5, 0.9], [0.5, 0.4, 0.7], [0.6, 0.3, 0.5], [0.7, 0.2, 0.3], [0.8, 0.1, 0.1]], &#39;changePoints&#39;: [0, 400, 800, 1200, 1600]}
 - with &#39;listOfMeans&#39; = [[0.4 0.5 0.9]
 [0.5 0.4 0.7]
 [0.6 0.3 0.5]
 [0.7 0.2 0.3]
 [0.8 0.1 0.1]]
 - with &#39;changePoints&#39; = [0, 400, 800, 1200, 1600]


 ==&gt; Creating the dynamic arms ...
   - with &#39;nbArms&#39; = 3
   - with &#39;arms&#39; = [B(0.4), B(0.5), B(0.9)]
 - Initial draw of &#39;means&#39; = [0.4 0.5 0.9]
Number of environments to try: 2
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">printAll</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">envId</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Giving the vector of final regrets ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">printLastRegrets</span><span class="p">(</span><span class="n">envId</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Giving the final ranks ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">printFinalRanking</span><span class="p">(</span><span class="n">envId</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Giving the mean and std running times ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">printRunningTimes</span><span class="p">(</span><span class="n">envId</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Giving the mean and std memory consumption ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">printMemoryConsumption</span><span class="p">(</span><span class="n">envId</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Solving-the-problem">
<h2>Solving the problem<a class="headerlink" href="#Solving-the-problem" title="Permalink to this headline">Â¶</a></h2>
<p>Now we can simulate all the environments.</p>
<p>WARNING That part takes some time, most stationary algorithms run with a time complexity linear in the horizon (ie., time takes <span class="math notranslate nohighlight">\(\mathcal{O}(T)\)</span>) and most piecewise stationary algorithms run with a time complexity <strong>square</strong> in the horizon (ie., time takes <span class="math notranslate nohighlight">\(\mathcal{O}(T^2)\)</span>).</p>
<div class="section" id="First-problem">
<h3>First problem<a class="headerlink" href="#First-problem" title="Permalink to this headline">Â¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="n">envId</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">[</span><span class="n">envId</span><span class="p">]</span>
<span class="c1"># Show the problem</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">plotHistoryOfMeans</span><span class="p">(</span><span class="n">envId</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: forcing to use putatright = False because there is 3 items in the legend.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_51_1.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_51_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 1.55 s, sys: 301 ms, total: 1.85 s
Wall time: 1.43 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="c1"># Evaluate just that env</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">startOneEnv</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Evaluating environment: PieceWiseStationaryMAB(nbArms: 3, arms: [B(0.2), B(0.5), B(0.9)])
- Adding policy #1 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;params&#39;: {}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][0]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;params&#39;: {}} ...
- Adding policy #2 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.UCBalpha.UCBalpha&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][1]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.UCBalpha.UCBalpha&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1}} ...
- Adding policy #3 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;params&#39;: {&#39;klucb&#39;: &lt;built-in function klucbBern&gt;}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][2]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;params&#39;: {&#39;klucb&#39;: &lt;built-in function klucbBern&gt;}} ...
- Adding policy #4 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Thompson.Thompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.Beta.Beta&#39;&gt;}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][3]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Thompson.Thompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.Beta.Beta&#39;&gt;}} ...
- Adding policy #5 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.99}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][4]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.99}} ...
- Adding policy #6 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.9}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][5]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.9}} ...
- Adding policy #7 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.7}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][6]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.7}} ...
- Adding policy #8 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3R&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][7]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3R&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
Warning: the policy Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$) tried to use default value of gamma = 0.11191812753316992 but could not set attribute self.policy.gamma to gamma (maybe it&#39;s using an Exp3 with a non-constant value of gamma).
- Adding policy #9 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3RPlusPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][8]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3RPlusPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
Warning: the policy Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$) tried to use default value of gamma = 0.11191812753316992 but could not set attribute self.policy.gamma to gamma (maybe it&#39;s using an Exp3 with a non-constant value of gamma).
- Adding policy #10 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][9]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #11 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][10]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #12 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][11]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #13 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][12]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #14 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][13]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
- Adding policy #15 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][14]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
- Adding policy #16 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][15]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
- Adding policy #17 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][16]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
- Adding policy #18 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][17]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
- Adding policy #19 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][18]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
- Adding policy #20 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][19]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Warning: the formula for gamma in the paper gave gamma = 0.0, that&#39;s absurd, we use instead 0.006622516556291391
- Adding policy #21 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][20]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
Warning: the formula for gamma in the paper gave gamma = 0.0, that&#39;s absurd, we use instead 0.006622516556291391
- Adding policy #22 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SWHash_UCB.SWHash_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1.0, &#39;lmbda&#39;: 1, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][21]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SWHash_UCB.SWHash_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1.0, &#39;lmbda&#39;: 1, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;}} ...
- Adding policy #23 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SlidingWindowUCB.SWUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;alpha&#39;: 1.0}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][22]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SlidingWindowUCB.SWUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;alpha&#39;: 1.0}} ...
- Adding policy #24 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedUCB.DiscountedUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;max_nb_random_events&#39;: 5, &#39;alpha&#39;: 1.0, &#39;horizon&#39;: 2000}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][23]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedUCB.DiscountedUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;max_nb_random_events&#39;: 5, &#39;alpha&#39;: 1.0, &#39;horizon&#39;: 2000}} ...
- Adding policy #25 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][24]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Info: creating a new policy OracleRestart-UCB($\Upsilon_T=4$, Per-Arm), with change points = [400, 800, 1200, 1600]...
- Adding policy #26 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][25]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Info: creating a new policy OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm), with change points = [400, 800, 1200, 1600]...
- Adding policy #27 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][26]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Info: creating a new policy OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm), with change points = [400, 800, 1200, 1600]...



- Evaluating policy #1/27: Exp3++ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7a0dd9219df847ac8b16aee0596e1e07", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #2/27: UCB($\alpha=1$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "49987eaffcbc452289ce0194fc1847da", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #3/27: kl-UCB ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5e0baad6833a466bb45f25ee110db475", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #4/27: Thompson ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "592345029bb549899ee3bbe2f668a896", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #5/27: DiscountedThompson($\gamma=0.99$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "54f46b54a3b44de58c2cb0b928d50b5c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #6/27: DiscountedThompson($\gamma=0.9$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3acc26c4f92d437a8677a9c3b63ffe64", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #7/27: DiscountedThompson($\gamma=0.7$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "856cad77d4fb4ae4b92202bd8a3fecff", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #8/27: Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9eb7bd74dcdf44319ce8944cf19e056b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #9/27: Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4e4ab321165a465d9159d3497c21ff38", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #10/27: CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a75d3035ca3b43e8a2e83bbdbaa42a13", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #11/27: CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a44af9d90c0049bc833dd5207a460c6f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #12/27: PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ed92942fcace4ab68e933c11f29525e7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #13/27: PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "66e225d5418643b0839a97381348084c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #14/27: BernoulliGLR-klUCB(Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "38492dd57ef64596920f627ba4881a7a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #15/27: BernoulliGLR-klUCB(Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "38c2b21195f046a18be99219ce91808d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #16/27: GaussianGLR-klUCB(Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f048fd1e7e724540b192d2ba72de4076", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #17/27: GaussianGLR-klUCB(Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0a3b27de92864f55ac1a3b164c155fed", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #18/27: SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4033c1f2d7c04da684498d1d04751ac9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #19/27: SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3978d08cfdbb4f96b728343625e8f735", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #20/27: M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "232c2711c5314dfa8e00abb9e53ee04d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #21/27: M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c822b293a5324c35b6134f63996f0861", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #22/27: SW-UCB#($\lambda=1$, $\alpha=1$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c5e8154e946468c94acbce3eb7f307d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #23/27: SW-UCB+($\tau=493$, $\alpha=1$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "775ac0d60a7e4228a6b8fa2de87380c3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #24/27: D-UCB+($\alpha=1$, $\gamma=0.9875$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cd3655227dbd4859810d59427f2a6061", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #25/27: OracleRestart-UCB($\Upsilon_T=4$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "35b6bb439b204a1f89dd7d2293ebb25f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #26/27: OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8395e7b5b4b0489a80e805380f20c392", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #27/27: OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c652291fd1b04d939dcdea9364e7a167", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

CPU times: user 16.6 s, sys: 403 ms, total: 17 s
Wall time: 22min 52s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">printAll</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">envId</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Giving the vector of final regrets ...

  For policy #0 called &#39;Exp3++&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 476
Mean of   last regrets R_T = 476
Median of last regrets R_T = 476
Max of    last regrets R_T = 476
STD of    last regrets R_T = 5.68e-14

  For policy #1 called &#39;UCB($\alpha=1$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 87.5
Mean of   last regrets R_T = 87.5
Median of last regrets R_T = 87.5
Max of    last regrets R_T = 87.5
STD of    last regrets R_T = 1.42e-14

  For policy #2 called &#39;kl-UCB&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 92.6
Mean of   last regrets R_T = 92.6
Median of last regrets R_T = 92.6
Max of    last regrets R_T = 92.6
STD of    last regrets R_T = 1.42e-14

  For policy #3 called &#39;Thompson&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 215
Mean of   last regrets R_T = 215
Median of last regrets R_T = 215
Max of    last regrets R_T = 215
STD of    last regrets R_T = 0

  For policy #4 called &#39;DiscountedThompson($\gamma=0.99$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 27.4
Mean of   last regrets R_T = 27.4
Median of last regrets R_T = 27.4
Max of    last regrets R_T = 27.4
STD of    last regrets R_T = 0

  For policy #5 called &#39;DiscountedThompson($\gamma=0.9$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 171
Mean of   last regrets R_T = 171
Median of last regrets R_T = 171
Max of    last regrets R_T = 171
STD of    last regrets R_T = 0

  For policy #6 called &#39;DiscountedThompson($\gamma=0.7$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 426
Mean of   last regrets R_T = 426
Median of last regrets R_T = 426
Max of    last regrets R_T = 426
STD of    last regrets R_T = 5.68e-14

  For policy #7 called &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 587
Mean of   last regrets R_T = 587
Median of last regrets R_T = 587
Max of    last regrets R_T = 587
STD of    last regrets R_T = 0

  For policy #8 called &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 550
Mean of   last regrets R_T = 550
Median of last regrets R_T = 550
Max of    last regrets R_T = 550
STD of    last regrets R_T = 1.14e-13

  For policy #9 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 25.5
Mean of   last regrets R_T = 25.5
Median of last regrets R_T = 25.5
Max of    last regrets R_T = 25.5
STD of    last regrets R_T = 0

  For policy #10 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 31.6
Mean of   last regrets R_T = 31.6
Median of last regrets R_T = 31.6
Max of    last regrets R_T = 31.6
STD of    last regrets R_T = 0

  For policy #11 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 28.8
Mean of   last regrets R_T = 28.8
Median of last regrets R_T = 28.8
Max of    last regrets R_T = 28.8
STD of    last regrets R_T = 0

  For policy #12 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 24.4
Mean of   last regrets R_T = 24.4
Median of last regrets R_T = 24.4
Max of    last regrets R_T = 24.4
STD of    last regrets R_T = 0

  For policy #13 called &#39;BernoulliGLR-klUCB(Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 21.1
Mean of   last regrets R_T = 21.1
Median of last regrets R_T = 21.1
Max of    last regrets R_T = 21.1
STD of    last regrets R_T = 0

  For policy #14 called &#39;BernoulliGLR-klUCB(Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 37.6
Mean of   last regrets R_T = 37.6
Median of last regrets R_T = 37.6
Max of    last regrets R_T = 37.6
STD of    last regrets R_T = 0

  For policy #15 called &#39;GaussianGLR-klUCB(Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 27.8
Mean of   last regrets R_T = 27.8
Median of last regrets R_T = 27.8
Max of    last regrets R_T = 27.8
STD of    last regrets R_T = 0

  For policy #16 called &#39;GaussianGLR-klUCB(Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 36.9
Mean of   last regrets R_T = 36.9
Median of last regrets R_T = 36.9
Max of    last regrets R_T = 36.9
STD of    last regrets R_T = 0

  For policy #17 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 89.2
Mean of   last regrets R_T = 89.2
Median of last regrets R_T = 89.2
Max of    last regrets R_T = 89.2
STD of    last regrets R_T = 1.42e-14

  For policy #18 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 127
Mean of   last regrets R_T = 127
Median of last regrets R_T = 127
Max of    last regrets R_T = 127
STD of    last regrets R_T = 1.42e-14

  For policy #19 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 28.4
Mean of   last regrets R_T = 28.4
Median of last regrets R_T = 28.4
Max of    last regrets R_T = 28.4
STD of    last regrets R_T = 0

  For policy #20 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 31.5
Mean of   last regrets R_T = 31.5
Median of last regrets R_T = 31.5
Max of    last regrets R_T = 31.5
STD of    last regrets R_T = 0

  For policy #21 called &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 79.5
Mean of   last regrets R_T = 79.5
Median of last regrets R_T = 79.5
Max of    last regrets R_T = 79.5
STD of    last regrets R_T = 1.42e-14

  For policy #22 called &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 77.5
Mean of   last regrets R_T = 77.5
Median of last regrets R_T = 77.5
Max of    last regrets R_T = 77.5
STD of    last regrets R_T = 0

  For policy #23 called &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 578
Mean of   last regrets R_T = 578
Median of last regrets R_T = 578
Max of    last regrets R_T = 578
STD of    last regrets R_T = 0

  For policy #24 called &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 85.9
Mean of   last regrets R_T = 85.9
Median of last regrets R_T = 85.9
Max of    last regrets R_T = 85.9
STD of    last regrets R_T = 1.42e-14

  For policy #25 called &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 56.8
Mean of   last regrets R_T = 56.8
Median of last regrets R_T = 56.8
Max of    last regrets R_T = 56.8
STD of    last regrets R_T = 0

  For policy #26 called &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 483
Mean of   last regrets R_T = 483
Median of last regrets R_T = 483
Max of    last regrets R_T = 483
STD of    last regrets R_T = 1.14e-13

Giving the final ranks ...

Final ranking for this environment #0 :
- Policy &#39;BernoulliGLR-klUCB(Per-Arm)&#39;  was ranked      1 / 27 for this simulation (last regret = 21.146).
- Policy &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39;        was ranked      2 / 27 for this simulation (last regret = 24.43).
- Policy &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39;     was ranked      3 / 27 for this simulation (last regret = 25.476).
- Policy &#39;DiscountedThompson($\gamma=0.99$)&#39;    was ranked      4 / 27 for this simulation (last regret = 27.378).
- Policy &#39;GaussianGLR-klUCB(Per-Arm)&#39;   was ranked      5 / 27 for this simulation (last regret = 27.776).
- Policy &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39;      was ranked      6 / 27 for this simulation (last regret = 28.386).
- Policy &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39;       was ranked      7 / 27 for this simulation (last regret = 28.796).
- Policy &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39;       was ranked      8 / 27 for this simulation (last regret = 31.53).
- Policy &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39;      was ranked      9 / 27 for this simulation (last regret = 31.612).
- Policy &#39;GaussianGLR-klUCB(Global)&#39;    was ranked      10 / 27 for this simulation (last regret = 36.912).
- Policy &#39;BernoulliGLR-klUCB(Global)&#39;   was ranked      11 / 27 for this simulation (last regret = 37.576).
- Policy &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; was ranked      12 / 27 for this simulation (last regret = 56.806).
- Policy &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39;      was ranked      13 / 27 for this simulation (last regret = 77.386).
- Policy &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39;     was ranked      14 / 27 for this simulation (last regret = 79.482).
- Policy &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39;   was ranked      15 / 27 for this simulation (last regret = 85.9).
- Policy &#39;UCB($\alpha=1$)&#39;      was ranked      16 / 27 for this simulation (last regret = 87.53).
- Policy &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; was ranked      17 / 27 for this simulation (last regret = 88.882).
- Policy &#39;kl-UCB&#39;       was ranked      18 / 27 for this simulation (last regret = 92.558).
- Policy &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39;  was ranked      19 / 27 for this simulation (last regret = 126.09).
- Policy &#39;DiscountedThompson($\gamma=0.9$)&#39;     was ranked      20 / 27 for this simulation (last regret = 169.78).
- Policy &#39;Thompson&#39;     was ranked      21 / 27 for this simulation (last regret = 214.75).
- Policy &#39;DiscountedThompson($\gamma=0.7$)&#39;     was ranked      22 / 27 for this simulation (last regret = 424.28).
- Policy &#39;Exp3++&#39;       was ranked      23 / 27 for this simulation (last regret = 473.69).
- Policy &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39;  was ranked      24 / 27 for this simulation (last regret = 480.71).
- Policy &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39;  was ranked      25 / 27 for this simulation (last regret = 545.47).
- Policy &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39;  was ranked      26 / 27 for this simulation (last regret = 573.37).
- Policy &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39;     was ranked      27 / 27 for this simulation (last regret = 583.93).

Giving the mean and std running times ...

For policy #6 called &#39;DiscountedThompson($\gamma=0.7$)&#39; ...
    120 ms Â± 21.2 ms per loop (mean Â± std. dev. of 50 runs)

For policy #3 called &#39;Thompson&#39; ...
    142 ms Â± 46.4 ms per loop (mean Â± std. dev. of 50 runs)

For policy #4 called &#39;DiscountedThompson($\gamma=0.99$)&#39; ...
    145 ms Â± 38.3 ms per loop (mean Â± std. dev. of 50 runs)

For policy #5 called &#39;DiscountedThompson($\gamma=0.9$)&#39; ...
    145 ms Â± 31.8 ms per loop (mean Â± std. dev. of 50 runs)

For policy #24 called &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    215 ms Â± 73.4 ms per loop (mean Â± std. dev. of 50 runs)

For policy #1 called &#39;UCB($\alpha=1$)&#39; ...
    316 ms Â± 84.7 ms per loop (mean Â± std. dev. of 50 runs)

For policy #25 called &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    361 ms Â± 67.8 ms per loop (mean Â± std. dev. of 50 runs)

For policy #2 called &#39;kl-UCB&#39; ...
    365 ms Â± 81.4 ms per loop (mean Â± std. dev. of 50 runs)

For policy #23 called &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39; ...
    432 ms Â± 103 ms per loop (mean Â± std. dev. of 50 runs)

For policy #22 called &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39; ...
    639 ms Â± 150 ms per loop (mean Â± std. dev. of 50 runs)

For policy #20 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39; ...
    688 ms Â± 243 ms per loop (mean Â± std. dev. of 50 runs)

For policy #19 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39; ...
    821 ms Â± 245 ms per loop (mean Â± std. dev. of 50 runs)

For policy #0 called &#39;Exp3++&#39; ...
    1.13 s Â± 236 ms per loop (mean Â± std. dev. of 50 runs)

For policy #26 called &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39; ...
    1.14 s Â± 275 ms per loop (mean Â± std. dev. of 50 runs)

For policy #7 called &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39; ...
    1.27 s Â± 134 ms per loop (mean Â± std. dev. of 50 runs)

For policy #8 called &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39; ...
    1.45 s Â± 121 ms per loop (mean Â± std. dev. of 50 runs)

For policy #11 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    2.21 s Â± 329 ms per loop (mean Â± std. dev. of 50 runs)

For policy #12 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    2.75 s Â± 951 ms per loop (mean Â± std. dev. of 50 runs)

For policy #9 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    2.99 s Â± 586 ms per loop (mean Â± std. dev. of 50 runs)

For policy #10 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    3.22 s Â± 1.02 s per loop (mean Â± std. dev. of 50 runs)

For policy #21 called &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39; ...
    3.46 s Â± 643 ms per loop (mean Â± std. dev. of 50 runs)

For policy #18 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39; ...
    5.21 s Â± 2.65 s per loop (mean Â± std. dev. of 50 runs)

For policy #17 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; ...
    7.67 s Â± 1.75 s per loop (mean Â± std. dev. of 50 runs)

For policy #13 called &#39;BernoulliGLR-klUCB(Per-Arm)&#39; ...
    15.7 s Â± 3.76 s per loop (mean Â± std. dev. of 50 runs)

For policy #16 called &#39;GaussianGLR-klUCB(Global)&#39; ...
    17.4 s Â± 3.56 s per loop (mean Â± std. dev. of 50 runs)

For policy #15 called &#39;GaussianGLR-klUCB(Per-Arm)&#39; ...
    18 s Â± 2.78 s per loop (mean Â± std. dev. of 50 runs)

For policy #14 called &#39;BernoulliGLR-klUCB(Global)&#39; ...
    18.5 s Â± 3.84 s per loop (mean Â± std. dev. of 50 runs)

Giving the mean and std memory consumption ...

For policy #1 called &#39;UCB($\alpha=1$)&#39; ...
    636 B Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #3 called &#39;Thompson&#39; ...
    826.9 B Â± 0.3 B (mean Â± std. dev. of 50 runs)

For policy #5 called &#39;DiscountedThompson($\gamma=0.9$)&#39; ...
    994 B Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #6 called &#39;DiscountedThompson($\gamma=0.7$)&#39; ...
    994 B Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #4 called &#39;DiscountedThompson($\gamma=0.99$)&#39; ...
    995 B Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #2 called &#39;kl-UCB&#39; ...
    1007 B Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #0 called &#39;Exp3++&#39; ...
    1 KiB Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #23 called &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39; ...
    1.2 KiB Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #18 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39; ...
    2.9 KiB Â± 990.6 B (mean Â± std. dev. of 50 runs)

For policy #17 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; ...
    4.4 KiB Â± 1.7 KiB (mean Â± std. dev. of 50 runs)

For policy #25 called &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    7.2 KiB Â± 720.5 B (mean Â± std. dev. of 50 runs)

For policy #26 called &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39; ...
    7.5 KiB Â± 1003.7 B (mean Â± std. dev. of 50 runs)

For policy #24 called &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    7.6 KiB Â± 934.6 B (mean Â± std. dev. of 50 runs)

For policy #16 called &#39;GaussianGLR-klUCB(Global)&#39; ...
    8.1 KiB Â± 1.2 KiB (mean Â± std. dev. of 50 runs)

For policy #14 called &#39;BernoulliGLR-klUCB(Global)&#39; ...
    8.5 KiB Â± 1.7 KiB (mean Â± std. dev. of 50 runs)

For policy #22 called &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39; ...
    8.6 KiB Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #10 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    8.8 KiB Â± 3.2 KiB (mean Â± std. dev. of 50 runs)

For policy #15 called &#39;GaussianGLR-klUCB(Per-Arm)&#39; ...
    10.5 KiB Â± 1.2 KiB (mean Â± std. dev. of 50 runs)

For policy #13 called &#39;BernoulliGLR-klUCB(Per-Arm)&#39; ...
    10.6 KiB Â± 757.1 B (mean Â± std. dev. of 50 runs)

For policy #9 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    10.6 KiB Â± 2.3 KiB (mean Â± std. dev. of 50 runs)

For policy #20 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39; ...
    11.5 KiB Â± 1.7 KiB (mean Â± std. dev. of 50 runs)

For policy #19 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39; ...
    12 KiB Â± 1.7 KiB (mean Â± std. dev. of 50 runs)

For policy #12 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    12 KiB Â± 49.4 B (mean Â± std. dev. of 50 runs)

For policy #11 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    12.1 KiB Â± 73.3 B (mean Â± std. dev. of 50 runs)

For policy #7 called &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39; ...
    18.9 KiB Â± 0.5 B (mean Â± std. dev. of 50 runs)

For policy #8 called &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39; ...
    19.1 KiB Â± 0 B (mean Â± std. dev. of 50 runs)

For policy #21 called &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39; ...
    78.6 KiB Â± 0 B (mean Â± std. dev. of 50 runs)
</pre></div></div>
</div>
</div>
<div class="section" id="Second-problem">
<h3>Second problem<a class="headerlink" href="#Second-problem" title="Permalink to this headline">Â¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="n">envId</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">[</span><span class="n">envId</span><span class="p">]</span>
<span class="c1"># Show the problem</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">plotHistoryOfMeans</span><span class="p">(</span><span class="n">envId</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: forcing to use putatright = False because there is 3 items in the legend.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_55_1.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_55_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 1.05 s, sys: 368 ms, total: 1.42 s
Wall time: 959 ms
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="c1"># Evaluate just that env</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">startOneEnv</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Evaluating environment: PieceWiseStationaryMAB(nbArms: 3, arms: [B(0.4), B(0.5), B(0.9)])
- Adding policy #1 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;params&#39;: {}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][0]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;params&#39;: {}} ...
- Adding policy #2 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.UCBalpha.UCBalpha&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][1]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.UCBalpha.UCBalpha&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1}} ...
- Adding policy #3 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;params&#39;: {&#39;klucb&#39;: &lt;built-in function klucbBern&gt;}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][2]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;params&#39;: {&#39;klucb&#39;: &lt;built-in function klucbBern&gt;}} ...
- Adding policy #4 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Thompson.Thompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.Beta.Beta&#39;&gt;}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][3]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Thompson.Thompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.Beta.Beta&#39;&gt;}} ...
- Adding policy #5 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.99}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][4]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.99}} ...
- Adding policy #6 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.9}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][5]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.9}} ...
- Adding policy #7 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.7}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][6]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedThompson.DiscountedThompson&#39;&gt;, &#39;params&#39;: {&#39;posterior&#39;: &lt;class &#39;SMPyBandits.Policies.Posterior.DiscountedBeta.DiscountedBeta&#39;&gt;, &#39;gamma&#39;: 0.7}} ...
- Adding policy #8 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3R&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][7]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3R&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
Warning: the policy Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$) tried to use default value of gamma = 0.11191812753316992 but could not set attribute self.policy.gamma to gamma (maybe it&#39;s using an Exp3 with a non-constant value of gamma).
- Adding policy #9 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3RPlusPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][8]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.Exp3RPlusPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000}} ...
Warning: the policy Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$) tried to use default value of gamma = 0.11191812753316992 but could not set attribute self.policy.gamma to gamma (maybe it&#39;s using an Exp3 with a non-constant value of gamma).
- Adding policy #10 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][9]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #11 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][10]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.CUSUM_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #12 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][11]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #13 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][12]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.PHT_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;max_nb_random_events&#39;: 5, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
compute_h_alpha_from_input_parameters__CUSUM() with:
T = 2000, UpsilonT = 5, K = 3, epsilon = 0.5, lmbda = 1, M = 100
Gave C2 = 1.0986122886681098, C1- = 2.1972245773362196 and C1+ = 0.6359887667199967 so C1 = 0.6359887667199967, and h = 9.420708132956397 and alpha = 0.0048256437784349945
- Adding policy #14 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][13]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
- Adding policy #15 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][14]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.BernoulliGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
- Adding policy #16 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][15]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
- Adding policy #17 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][16]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.GaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
- Adding policy #18 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][17]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
- Adding policy #19 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][18]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.CD_UCB.SubGaussianGLR_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
- Adding policy #20 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][19]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Warning: the formula for gamma in the paper gave gamma = 0.0, that&#39;s absurd, we use instead 0.006622516556291391
- Adding policy #21 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][20]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.Monitored_UCB.Monitored_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;w&#39;: 80, &#39;b&#39;: 26.07187326473663, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: False}} ...
Warning: the formula for gamma in the paper gave gamma = 0.0, that&#39;s absurd, we use instead 0.006622516556291391
- Adding policy #22 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SWHash_UCB.SWHash_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1.0, &#39;lmbda&#39;: 1, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][21]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SWHash_UCB.SWHash_IndexPolicy&#39;&gt;, &#39;params&#39;: {&#39;alpha&#39;: 1.0, &#39;lmbda&#39;: 1, &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;}} ...
- Adding policy #23 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SlidingWindowUCB.SWUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;alpha&#39;: 1.0}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][22]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.SlidingWindowUCB.SWUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;horizon&#39;: 2000, &#39;alpha&#39;: 1.0}} ...
- Adding policy #24 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedUCB.DiscountedUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;max_nb_random_events&#39;: 5, &#39;alpha&#39;: 1.0, &#39;horizon&#39;: 2000}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][23]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.DiscountedUCB.DiscountedUCBPlus&#39;&gt;, &#39;params&#39;: {&#39;max_nb_random_events&#39;: 5, &#39;alpha&#39;: 1.0, &#39;horizon&#39;: 2000}} ...
- Adding policy #25 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][24]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.UCB.UCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Info: creating a new policy OracleRestart-UCB($\Upsilon_T=4$, Per-Arm), with change points = [400, 800, 1200, 1600]...
- Adding policy #26 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][25]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.klUCB.klUCB&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Info: creating a new policy OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm), with change points = [400, 800, 1200, 1600]...
- Adding policy #27 = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
  Creating this policy from a dictionnary &#39;self.cfg[&#39;policies&#39;][26]&#39; = {&#39;archtype&#39;: &lt;class &#39;SMPyBandits.Policies.OracleSequentiallyRestartPolicy.OracleSequentiallyRestartPolicy&#39;&gt;, &#39;params&#39;: {&#39;changePoints&#39;: array([   0,  400,  800, 1200, 1600]), &#39;policy&#39;: &lt;class &#39;SMPyBandits.Policies.Exp3PlusPlus.Exp3PlusPlus&#39;&gt;, &#39;per_arm_restart&#39;: True}} ...
Info: creating a new policy OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm), with change points = [400, 800, 1200, 1600]...



- Evaluating policy #1/27: Exp3++ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bf5a0c4aea664d5fa2ea25d727e20625", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>



- Evaluating policy #2/27: UCB($\alpha=1$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    1.9s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    1.9s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "48b9acf4dc0c4767a3505779d10551b7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #3/27: kl-UCB ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.4s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.4s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d97f09ad6231425ea9843ed8b3a19c54", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #4/27: Thompson ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.7s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.7s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b8b1e6f1c2b14b62ae53ca4b57cf6157", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #5/27: DiscountedThompson($\gamma=0.99$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.3s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.3s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8b40963838144d8b983f81a8c7254263", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #6/27: DiscountedThompson($\gamma=0.9$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.4s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.4s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7fe20d59f0344ecab3145838a634e250", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #7/27: DiscountedThompson($\gamma=0.7$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.3s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.3s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5492c8c8e8d343fead7393e5de1da77d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #8/27: Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.3s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.3s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5355c13979594567a7697811960737e2", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #9/27: Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    3.1s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    3.1s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "82eb7ae87d874b3d8d7b70ddd7b46e57", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #10/27: CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    4.1s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    4.1s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "25e72e989fc045899e00ed0a4bccb154", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #11/27: CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   12.9s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   12.9s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "af7bf107d0fb4ba992cac97cd70db392", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #12/27: PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   13.1s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   13.1s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ac5fbd265b84c1c9cc76174697f7db1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #13/27: PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    7.2s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    7.2s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d73b28d832314d379801e2fcbfa80639", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #14/27: BernoulliGLR-klUCB(Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    6.1s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    6.1s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "307b6d6b004a448b8e4a4d3a0b458ea9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #15/27: BernoulliGLR-klUCB(Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   57.5s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   57.5s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9befda4bf3a248fd814e1fa7f865e18d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #16/27: GaussianGLR-klUCB(Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   49.5s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   49.5s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6c943fd3e7494e15842c25f836d61282", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #17/27: GaussianGLR-klUCB(Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:  1.1min remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:  1.1min finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "431e1f855a9f4c788f0ae0aed6af3369", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #18/27: SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   57.7s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   57.7s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1758cb7c82cf4b7e9e1ed8f243c6a69e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #19/27: SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   11.1s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:   11.1s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8de34db8adf049e2b58b75d7b81165c6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #20/27: M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    8.7s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    8.7s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "08424b5815ea490fa2dfa983194d818c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #21/27: M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    1.1s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    1.1s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bb0ff045e14e4c8e8a3ead192d348747", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #22/27: SW-UCB#($\lambda=1$, $\alpha=1$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    1.1s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    1.1s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c212d104b1334b4bb571f99eaf9ceae0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #23/27: SW-UCB+($\tau=493$, $\alpha=1$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    7.5s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    7.5s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a2a34e9156d648cf814b33c7a7c8f5c0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #24/27: D-UCB+($\alpha=1$, $\gamma=0.9875$) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.8s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.8s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ddf8e1b1ede4897a3c27f9c91938011", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #25/27: OracleRestart-UCB($\Upsilon_T=4$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.6s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.6s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e0ddb072cf0442e49143d1b30052c306", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #26/27: OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.5s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.5s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cbbd1bb82fdd43d6ac0eb5c7aa0d45ad", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>




- Evaluating policy #27/27: OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.8s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    0.8s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e3f041b312454b8e9482025941672941", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

CPU times: user 1.3 s, sys: 116 ms, total: 1.42 s
Wall time: 5min 17s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    2.4s remaining:    0.0s
[Parallel(n_jobs=4)]: Done  10 out of  10 | elapsed:    2.4s finished
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Plotting-the-results">
<h2>Plotting the results<a class="headerlink" href="#Plotting-the-results" title="Permalink to this headline">Â¶</a></h2>
<p>And finally, visualize them, with the plotting method of a <code class="docutils literal notranslate"><span class="pre">Evaluator</span></code> object:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plotAll</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">envId</span><span class="p">,</span> <span class="n">mainfig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">savefig</span> <span class="o">=</span> <span class="n">mainfig</span>
    <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">savefig</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__LastRegrets__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plotting a boxplot of the final regrets ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">plotLastRegrets</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">boxplot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">savefig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">savefig</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__RunningTimes__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plotting the mean and std running times ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">plotRunningTimes</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">savefig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">savefig</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__MemoryConsumption__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plotting the mean and std memory consumption ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">plotMemoryConsumption</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">savefig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">savefig</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__Regrets__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plotting the mean regrets ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">plotRegrets</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">savefig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">savefig</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__MeanReward__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plotting the mean rewards ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">plotRegrets</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">meanReward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">savefig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">savefig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">savefig</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__LastRegrets__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plotting an histogram of the final regrets ...&quot;</span><span class="p">)</span>
    <span class="n">evaluation</span><span class="o">.</span><span class="n">plotLastRegrets</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">savefig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">evaluation</span><span class="o">.</span><span class="n">nb_break_points</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>5
</pre></div>
</div>
</div>
<div class="section" id="First-problem-with-change-on-only-one-arm-(Local-Restart-should-be-better)">
<h3>First problem with change on only one arm (Local Restart should be better)<a class="headerlink" href="#First-problem-with-change-on-only-one-arm-(Local-Restart-should-be-better)" title="Permalink to this headline">Â¶</a></h3>
<p>Letâ€™s first print the results then plot them:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">envId</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">plotHistoryOfMeans</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__HistoryOfMeans__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: forcing to use putatright = False because there is 3 items in the legend.
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__HistoryOfMeans__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__HistoryOfMeans__env1-2.png&#39; created of size &#39;107560b&#39;, at &#39;Wed Dec 19 17:46:13 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__HistoryOfMeans__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__HistoryOfMeans__env1-2.pdf&#39; created of size &#39;24239b&#39;, at &#39;Wed Dec 19 17:46:14 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_62_1.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_62_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plotAll</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">envId</span><span class="p">,</span> <span class="n">mainfig</span><span class="o">=</span><span class="n">mainfig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting a boxplot of the final regrets ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.png&#39; created of size &#39;273865b&#39;, at &#39;Wed Dec 19 17:46:17 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.pdf&#39; created of size &#39;50192b&#39;, at &#39;Wed Dec 19 17:46:18 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_1.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean and std running times ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__RunningTimes__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__RunningTimes__env1-2.png&#39; created of size &#39;258104b&#39;, at &#39;Wed Dec 19 17:46:22 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__RunningTimes__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__RunningTimes__env1-2.pdf&#39; created of size &#39;44962b&#39;, at &#39;Wed Dec 19 17:46:22 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_3.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean and std memory consumption ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__MemoryConsumption__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__MemoryConsumption__env1-2.png&#39; created of size &#39;262365b&#39;, at &#39;Wed Dec 19 17:46:25 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__MemoryConsumption__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__MemoryConsumption__env1-2.pdf&#39; created of size &#39;45926b&#39;, at &#39;Wed Dec 19 17:46:26 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_5.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean regrets ...

This MAB problem has:
 - a [Lai &amp; Robbins] complexity constant C(mu) = 1.3 for 1-player problem...
 - a Optimal Arm Identification factor H_OI(mu) = 30.00% ...
Warning: forcing to use putatright = True because there is 27 items in the legend.
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__Regrets__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__Regrets__env1-2.png&#39; created of size &#39;450877b&#39;, at &#39;Wed Dec 19 17:46:29 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__Regrets__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__Regrets__env1-2.pdf&#39; created of size &#39;88974b&#39;, at &#39;Wed Dec 19 17:46:30 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_7.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean rewards ...

This MAB problem has:
 - a [Lai &amp; Robbins] complexity constant C(mu) = 1.3 for 1-player problem...
 - a Optimal Arm Identification factor H_OI(mu) = 30.00% ...
Warning: forcing to use putatright = True because there is 28 items in the legend.
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__MeanReward__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__MeanReward__env1-2.png&#39; created of size &#39;526392b&#39;, at &#39;Wed Dec 19 17:46:33 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__MeanReward__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__MeanReward__env1-2.pdf&#39; created of size &#39;181615b&#39;, at &#39;Wed Dec 19 17:46:34 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_9.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the best arm pulls ...
Warning: forcing to use putatright = True because there is 27 items in the legend.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.6/dist-packages/matplotlib/figure.py:98: MatplotlibDeprecationWarning:
Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  &#34;Adding an axes using the same arguments as a previous axes &#34;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__BestArmPulls__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__BestArmPulls__env1-2.png&#39; created of size &#39;671356b&#39;, at &#39;Wed Dec 19 17:46:37 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__BestArmPulls__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__BestArmPulls__env1-2.pdf&#39; created of size &#39;169383b&#39;, at &#39;Wed Dec 19 17:46:38 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_13.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_13.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting an histogram of the final regrets ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.png&#39; created of size &#39;239881b&#39;, at &#39;Wed Dec 19 17:46:21 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N50__27_algos/main__LastRegrets__env1-2.pdf&#39; created of size &#39;57805b&#39;, at &#39;Wed Dec 19 17:46:21 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_15.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_63_15.png" />
</div>
</div>
</div>
<div class="section" id="Second-problem-with-changes-on-all-arms-(Global-restart-should-be-better)">
<h3>Second problem with changes on all arms (Global restart should be better)<a class="headerlink" href="#Second-problem-with-changes-on-all-arms-(Global-restart-should-be-better)" title="Permalink to this headline">Â¶</a></h3>
<p>Letâ€™s first print the results then plot them:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">envId</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">plotHistoryOfMeans</span><span class="p">(</span><span class="n">envId</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">__HistoryOfMeans__env</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mainfig</span><span class="p">,</span> <span class="n">envId</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">envs</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: forcing to use putatright = False because there is 3 items in the legend.
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__HistoryOfMeans__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__HistoryOfMeans__env2-2.png&#39; created of size &#39;87820b&#39;, at &#39;Wed Dec 19 17:09:57 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__HistoryOfMeans__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__HistoryOfMeans__env2-2.pdf&#39; created of size &#39;24393b&#39;, at &#39;Wed Dec 19 17:09:58 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_66_1.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_66_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">printAll</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">envId</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Giving the vector of final regrets ...

  For policy #0 called &#39;Exp3++&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 359
Mean of   last regrets R_T = 359
Median of last regrets R_T = 359
Max of    last regrets R_T = 359
STD of    last regrets R_T = 5.68e-14

  For policy #1 called &#39;UCB($\alpha=1$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 90.1
Mean of   last regrets R_T = 90.1
Median of last regrets R_T = 90.1
Max of    last regrets R_T = 90.1
STD of    last regrets R_T = 0

  For policy #2 called &#39;kl-UCB&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 72.6
Mean of   last regrets R_T = 72.6
Median of last regrets R_T = 72.6
Max of    last regrets R_T = 72.6
STD of    last regrets R_T = 0

  For policy #3 called &#39;Thompson&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 202
Mean of   last regrets R_T = 202
Median of last regrets R_T = 202
Max of    last regrets R_T = 202
STD of    last regrets R_T = 0

  For policy #4 called &#39;DiscountedThompson($\gamma=0.99$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 46.1
Mean of   last regrets R_T = 46.1
Median of last regrets R_T = 46.1
Max of    last regrets R_T = 46.1
STD of    last regrets R_T = 0

  For policy #5 called &#39;DiscountedThompson($\gamma=0.9$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 206
Mean of   last regrets R_T = 206
Median of last regrets R_T = 206
Max of    last regrets R_T = 206
STD of    last regrets R_T = 0

  For policy #6 called &#39;DiscountedThompson($\gamma=0.7$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 418
Mean of   last regrets R_T = 418
Median of last regrets R_T = 418
Max of    last regrets R_T = 418
STD of    last regrets R_T = 5.68e-14

  For policy #7 called &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 468
Mean of   last regrets R_T = 468
Median of last regrets R_T = 468
Max of    last regrets R_T = 468
STD of    last regrets R_T = 5.68e-14

  For policy #8 called &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 415
Mean of   last regrets R_T = 415
Median of last regrets R_T = 415
Max of    last regrets R_T = 415
STD of    last regrets R_T = 5.68e-14

  For policy #9 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 68.6
Mean of   last regrets R_T = 68.6
Median of last regrets R_T = 68.6
Max of    last regrets R_T = 68.6
STD of    last regrets R_T = 0

  For policy #10 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 70.9
Mean of   last regrets R_T = 70.9
Median of last regrets R_T = 70.9
Max of    last regrets R_T = 70.9
STD of    last regrets R_T = 0

  For policy #11 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 84.9
Mean of   last regrets R_T = 84.9
Median of last regrets R_T = 84.9
Max of    last regrets R_T = 84.9
STD of    last regrets R_T = 0

  For policy #12 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 81.8
Mean of   last regrets R_T = 81.8
Median of last regrets R_T = 81.8
Max of    last regrets R_T = 81.8
STD of    last regrets R_T = 0

  For policy #13 called &#39;BernoulliGLR-klUCB(Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 35
Mean of   last regrets R_T = 35
Median of last regrets R_T = 35
Max of    last regrets R_T = 35
STD of    last regrets R_T = 0

  For policy #14 called &#39;BernoulliGLR-klUCB(Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 34
Mean of   last regrets R_T = 34
Median of last regrets R_T = 34
Max of    last regrets R_T = 34
STD of    last regrets R_T = 0

  For policy #15 called &#39;GaussianGLR-klUCB(Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 43.1
Mean of   last regrets R_T = 43.1
Median of last regrets R_T = 43.1
Max of    last regrets R_T = 43.1
STD of    last regrets R_T = 0

  For policy #16 called &#39;GaussianGLR-klUCB(Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 45.2
Mean of   last regrets R_T = 45.2
Median of last regrets R_T = 45.2
Max of    last regrets R_T = 45.2
STD of    last regrets R_T = 0

  For policy #17 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 107
Mean of   last regrets R_T = 107
Median of last regrets R_T = 107
Max of    last regrets R_T = 107
STD of    last regrets R_T = 0

  For policy #18 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 134
Mean of   last regrets R_T = 134
Median of last regrets R_T = 134
Max of    last regrets R_T = 134
STD of    last regrets R_T = 0

  For policy #19 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 83.5
Mean of   last regrets R_T = 83.5
Median of last regrets R_T = 83.5
Max of    last regrets R_T = 83.5
STD of    last regrets R_T = 0

  For policy #20 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 82.3
Mean of   last regrets R_T = 82.3
Median of last regrets R_T = 82.3
Max of    last regrets R_T = 82.3
STD of    last regrets R_T = 0

  For policy #21 called &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 100
Mean of   last regrets R_T = 100
Median of last regrets R_T = 100
Max of    last regrets R_T = 100
STD of    last regrets R_T = 0

  For policy #22 called &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 84
Mean of   last regrets R_T = 84
Median of last regrets R_T = 84
Max of    last regrets R_T = 84
STD of    last regrets R_T = 0

  For policy #23 called &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 460
Mean of   last regrets R_T = 460
Median of last regrets R_T = 460
Max of    last regrets R_T = 460
STD of    last regrets R_T = 0

  For policy #24 called &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 74.3
Mean of   last regrets R_T = 74.3
Median of last regrets R_T = 74.3
Max of    last regrets R_T = 74.3
STD of    last regrets R_T = 0

  For policy #25 called &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 27.2
Mean of   last regrets R_T = 27.2
Median of last regrets R_T = 27.2
Max of    last regrets R_T = 27.2
STD of    last regrets R_T = 0

  For policy #26 called &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39; ...
  Last regrets (for all repetitions) have:
Min of    last regrets R_T = 365
Mean of   last regrets R_T = 365
Median of last regrets R_T = 365
Max of    last regrets R_T = 365
STD of    last regrets R_T = 5.68e-14

Giving the final ranks ...

Final ranking for this environment #1 :
- Policy &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; was ranked      1 / 27 for this simulation (last regret = 27.23).
- Policy &#39;BernoulliGLR-klUCB(Global)&#39;   was ranked      2 / 27 for this simulation (last regret = 33.96).
- Policy &#39;BernoulliGLR-klUCB(Per-Arm)&#39;  was ranked      3 / 27 for this simulation (last regret = 35.04).
- Policy &#39;GaussianGLR-klUCB(Per-Arm)&#39;   was ranked      4 / 27 for this simulation (last regret = 43.08).
- Policy &#39;GaussianGLR-klUCB(Global)&#39;    was ranked      5 / 27 for this simulation (last regret = 45.23).
- Policy &#39;DiscountedThompson($\gamma=0.99$)&#39;    was ranked      6 / 27 for this simulation (last regret = 46.15).
- Policy &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39;     was ranked      7 / 27 for this simulation (last regret = 68.56).
- Policy &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39;      was ranked      8 / 27 for this simulation (last regret = 70.88).
- Policy &#39;kl-UCB&#39;       was ranked      9 / 27 for this simulation (last regret = 72.65).
- Policy &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39;   was ranked      10 / 27 for this simulation (last regret = 74.35).
- Policy &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39;        was ranked      11 / 27 for this simulation (last regret = 81.81).
- Policy &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39;       was ranked      12 / 27 for this simulation (last regret = 82.35).
- Policy &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39;      was ranked      13 / 27 for this simulation (last regret = 83.47).
- Policy &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39;      was ranked      14 / 27 for this simulation (last regret = 83.68).
- Policy &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39;       was ranked      15 / 27 for this simulation (last regret = 84.85).
- Policy &#39;UCB($\alpha=1$)&#39;      was ranked      16 / 27 for this simulation (last regret = 90.15).
- Policy &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39;     was ranked      17 / 27 for this simulation (last regret = 100.23).
- Policy &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; was ranked      18 / 27 for this simulation (last regret = 106.39).
- Policy &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39;  was ranked      19 / 27 for this simulation (last regret = 134.29).
- Policy &#39;Thompson&#39;     was ranked      20 / 27 for this simulation (last regret = 202.02).
- Policy &#39;DiscountedThompson($\gamma=0.9$)&#39;     was ranked      21 / 27 for this simulation (last regret = 204.89).
- Policy &#39;Exp3++&#39;       was ranked      22 / 27 for this simulation (last regret = 357.15).
- Policy &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39;  was ranked      23 / 27 for this simulation (last regret = 363.73).
- Policy &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39;  was ranked      24 / 27 for this simulation (last regret = 412.56).
- Policy &#39;DiscountedThompson($\gamma=0.7$)&#39;     was ranked      25 / 27 for this simulation (last regret = 415.36).
- Policy &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39;  was ranked      26 / 27 for this simulation (last regret = 455.92).
- Policy &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39;     was ranked      27 / 27 for this simulation (last regret = 465.34).

Giving the mean and std running times ...

For policy #3 called &#39;Thompson&#39; ...
    105 ms Â± 21.6 ms per loop (mean Â± std. dev. of 10 runs)

For policy #5 called &#39;DiscountedThompson($\gamma=0.9$)&#39; ...
    119 ms Â± 22.9 ms per loop (mean Â± std. dev. of 10 runs)

For policy #6 called &#39;DiscountedThompson($\gamma=0.7$)&#39; ...
    122 ms Â± 24.9 ms per loop (mean Â± std. dev. of 10 runs)

For policy #4 called &#39;DiscountedThompson($\gamma=0.99$)&#39; ...
    124 ms Â± 19.1 ms per loop (mean Â± std. dev. of 10 runs)

For policy #1 called &#39;UCB($\alpha=1$)&#39; ...
    132 ms Â± 28.9 ms per loop (mean Â± std. dev. of 10 runs)

For policy #24 called &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    195 ms Â± 42 ms per loop (mean Â± std. dev. of 10 runs)

For policy #23 called &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39; ...
    209 ms Â± 34.9 ms per loop (mean Â± std. dev. of 10 runs)

For policy #2 called &#39;kl-UCB&#39; ...
    244 ms Â± 44.2 ms per loop (mean Â± std. dev. of 10 runs)

For policy #25 called &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    286 ms Â± 64.8 ms per loop (mean Â± std. dev. of 10 runs)

For policy #22 called &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39; ...
    296 ms Â± 80.9 ms per loop (mean Â± std. dev. of 10 runs)

For policy #19 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39; ...
    376 ms Â± 73.4 ms per loop (mean Â± std. dev. of 10 runs)

For policy #20 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39; ...
    400 ms Â± 97.8 ms per loop (mean Â± std. dev. of 10 runs)

For policy #0 called &#39;Exp3++&#39; ...
    678 ms Â± 118 ms per loop (mean Â± std. dev. of 10 runs)

For policy #26 called &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39; ...
    823 ms Â± 63 ms per loop (mean Â± std. dev. of 10 runs)

For policy #7 called &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39; ...
    1.09 s Â± 195 ms per loop (mean Â± std. dev. of 10 runs)

For policy #8 called &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39; ...
    1.5 s Â± 341 ms per loop (mean Â± std. dev. of 10 runs)

For policy #12 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    2.18 s Â± 422 ms per loop (mean Â± std. dev. of 10 runs)

For policy #11 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    2.61 s Â± 469 ms per loop (mean Â± std. dev. of 10 runs)

For policy #21 called &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39; ...
    2.7 s Â± 615 ms per loop (mean Â± std. dev. of 10 runs)

For policy #18 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39; ...
    3.06 s Â± 636 ms per loop (mean Â± std. dev. of 10 runs)

For policy #17 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; ...
    4.01 s Â± 920 ms per loop (mean Â± std. dev. of 10 runs)

For policy #9 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    4.45 s Â± 431 ms per loop (mean Â± std. dev. of 10 runs)

For policy #10 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    4.66 s Â± 1.35 s per loop (mean Â± std. dev. of 10 runs)

For policy #14 called &#39;BernoulliGLR-klUCB(Global)&#39; ...
    17.3 s Â± 1.5 s per loop (mean Â± std. dev. of 10 runs)

For policy #13 called &#39;BernoulliGLR-klUCB(Per-Arm)&#39; ...
    19.5 s Â± 2.84 s per loop (mean Â± std. dev. of 10 runs)

For policy #16 called &#39;GaussianGLR-klUCB(Global)&#39; ...
    21.2 s Â± 5.93 s per loop (mean Â± std. dev. of 10 runs)

For policy #15 called &#39;GaussianGLR-klUCB(Per-Arm)&#39; ...
    22.1 s Â± 4.45 s per loop (mean Â± std. dev. of 10 runs)

Giving the mean and std memory consumption ...

For policy #1 called &#39;UCB($\alpha=1$)&#39; ...
    572.8 B Â± 189.6 B (mean Â± std. dev. of 10 runs)

For policy #3 called &#39;Thompson&#39; ...
    744.5 B Â± 246.8 B (mean Â± std. dev. of 10 runs)

For policy #4 called &#39;DiscountedThompson($\gamma=0.99$)&#39; ...
    895.9 B Â± 297.3 B (mean Â± std. dev. of 10 runs)

For policy #5 called &#39;DiscountedThompson($\gamma=0.9$)&#39; ...
    994 B Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #6 called &#39;DiscountedThompson($\gamma=0.7$)&#39; ...
    994 B Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #2 called &#39;kl-UCB&#39; ...
    1007 B Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #0 called &#39;Exp3++&#39; ...
    1 KiB Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #23 called &#39;D-UCB+($\alpha=1$, $\gamma=0.9875$)&#39; ...
    1.2 KiB Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #18 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Global)&#39; ...
    2.6 KiB Â± 661.7 B (mean Â± std. dev. of 10 runs)

For policy #17 called &#39;SubGaussian-GLR-klUCB($\delta=0.001$, $\sigma=0.25$, joint, Per-Arm)&#39; ...
    4.3 KiB Â± 1.9 KiB (mean Â± std. dev. of 10 runs)

For policy #24 called &#39;OracleRestart-UCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    6.1 KiB Â± 2.2 KiB (mean Â± std. dev. of 10 runs)

For policy #25 called &#39;OracleRestart-klUCB($\Upsilon_T=4$, Per-Arm)&#39; ...
    6.6 KiB Â± 486.7 B (mean Â± std. dev. of 10 runs)

For policy #26 called &#39;OracleRestart-Exp3PlusPlus($\Upsilon_T=4$, Per-Arm)&#39; ...
    8.4 KiB Â± 2 KiB (mean Â± std. dev. of 10 runs)

For policy #22 called &#39;SW-UCB+($\tau=493$, $\alpha=1$)&#39; ...
    8.6 KiB Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #16 called &#39;GaussianGLR-klUCB(Global)&#39; ...
    10.8 KiB Â± 580.7 B (mean Â± std. dev. of 10 runs)

For policy #15 called &#39;GaussianGLR-klUCB(Per-Arm)&#39; ...
    12 KiB Â± 448.9 B (mean Â± std. dev. of 10 runs)

For policy #14 called &#39;BernoulliGLR-klUCB(Global)&#39; ...
    12.1 KiB Â± 543.7 B (mean Â± std. dev. of 10 runs)

For policy #13 called &#39;BernoulliGLR-klUCB(Per-Arm)&#39; ...
    12.4 KiB Â± 490.8 B (mean Â± std. dev. of 10 runs)

For policy #10 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    14.7 KiB Â± 5.7 KiB (mean Â± std. dev. of 10 runs)

For policy #9 called &#39;CUSUM-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    16.5 KiB Â± 4.4 KiB (mean Â± std. dev. of 10 runs)

For policy #19 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Per-Arm)&#39; ...
    17.4 KiB Â± 5.8 KiB (mean Â± std. dev. of 10 runs)

For policy #11 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Per-Arm)&#39; ...
    17.4 KiB Â± 5.8 KiB (mean Â± std. dev. of 10 runs)

For policy #7 called &#39;Exp3R($T=2000$, $c=4.02$, $\alpha=0.01$)&#39; ...
    18.9 KiB Â± 1 B (mean Â± std. dev. of 10 runs)

For policy #8 called &#39;Exp3R++($T=2000$, $c=0.73$, $\alpha=0.303$)&#39; ...
    19.1 KiB Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #20 called &#39;M-klUCB($w=80$, $b=26.0719$, $\gamma=0.00662$, Global)&#39; ...
    19.3 KiB Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #12 called &#39;PHT-klUCB($\varepsilon=0.5$, $\Upsilon_T=5$, $M=100$, Global)&#39; ...
    19.3 KiB Â± 0 B (mean Â± std. dev. of 10 runs)

For policy #21 called &#39;SW-UCB#($\lambda=1$, $\alpha=1$)&#39; ...
    78.6 KiB Â± 0 B (mean Â± std. dev. of 10 runs)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plotAll</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">envId</span><span class="p">,</span> <span class="n">mainfig</span><span class="o">=</span><span class="n">mainfig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting a boxplot of the final regrets ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.png&#39; created of size &#39;175728b&#39;, at &#39;Wed Dec 19 17:10:01 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.pdf&#39; created of size &#39;46885b&#39;, at &#39;Wed Dec 19 17:10:02 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_1.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean and std running times ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__RunningTimes__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__RunningTimes__env2-2.png&#39; created of size &#39;172500b&#39;, at &#39;Wed Dec 19 17:10:06 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__RunningTimes__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__RunningTimes__env2-2.pdf&#39; created of size &#39;45994b&#39;, at &#39;Wed Dec 19 17:10:07 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_3.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean and std memory consumption ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__MemoryConsumption__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__MemoryConsumption__env2-2.png&#39; created of size &#39;172934b&#39;, at &#39;Wed Dec 19 17:10:10 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__MemoryConsumption__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__MemoryConsumption__env2-2.pdf&#39; created of size &#39;43827b&#39;, at &#39;Wed Dec 19 17:10:11 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_5.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean regrets ...

This MAB problem has:
 - a [Lai &amp; Robbins] complexity constant C(mu) = 1.45 for 1-player problem...
 - a Optimal Arm Identification factor H_OI(mu) = 36.67% ...
Warning: forcing to use putatright = True because there is 27 items in the legend.
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__Regrets__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__Regrets__env2-2.png&#39; created of size &#39;362499b&#39;, at &#39;Wed Dec 19 17:10:14 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__Regrets__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__Regrets__env2-2.pdf&#39; created of size &#39;129263b&#39;, at &#39;Wed Dec 19 17:10:14 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_7.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the mean rewards ...

This MAB problem has:
 - a [Lai &amp; Robbins] complexity constant C(mu) = 1.45 for 1-player problem...
 - a Optimal Arm Identification factor H_OI(mu) = 36.67% ...
Warning: forcing to use putatright = True because there is 28 items in the legend.
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__MeanReward__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__MeanReward__env2-2.png&#39; created of size &#39;398408b&#39;, at &#39;Wed Dec 19 17:10:16 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__MeanReward__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__MeanReward__env2-2.pdf&#39; created of size &#39;293079b&#39;, at &#39;Wed Dec 19 17:10:17 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_9.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting the best arm pulls ...
Warning: forcing to use putatright = True because there is 27 items in the legend.
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__BestArmPulls__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__BestArmPulls__env2-2.png&#39; created of size &#39;403464b&#39;, at &#39;Wed Dec 19 17:10:19 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__BestArmPulls__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__BestArmPulls__env2-2.pdf&#39; created of size &#39;190480b&#39;, at &#39;Wed Dec 19 17:10:20 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_11.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_11.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Plotting an histogram of the final regrets ...
Saving figure with format png, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.png&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.png&#39; created of size &#39;149474b&#39;, at &#39;Wed Dec 19 17:10:07 2018&#39; ...
Saving figure with format pdf, to file &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.pdf&#39;...
       Saved! &#39;plots/SP__K3_T2000_N10__27_algos/main__LastRegrets__env2-2.pdf&#39; created of size &#39;55688b&#39;, at &#39;Wed Dec 19 17:10:07 2018&#39; ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_13.png" src="../_images/notebooks_Demonstrations_of_Single-Player_Simulations_for_Non-Stationary-Bandits_68_13.png" />
</div>
</div>
<hr class="docutils" />
<blockquote>
<div>Thatâ€™s it for this demo!</div></blockquote>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Profiling.html" class="btn btn-neutral float-right" title="A note on execution times, speed and profiling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Experiments_of_statistical_tests_for_piecewise_stationary_bandit.html" class="btn btn-neutral float-left" title="Table of Contents" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Lilian Besson (Naereen)
      <span class="lastupdated">
        Last updated on 28 Mar 2019, 20h.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>