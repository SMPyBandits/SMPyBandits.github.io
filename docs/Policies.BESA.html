

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-38514290-2']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
            </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Policies.BESA module &mdash; SMPyBandits 0.9.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="SMPyBandits 0.9.2 documentation" href="../index.html"/>
        <link rel="up" title="Policies package" href="Policies.html"/>
        <link rel="next" title="Policies.BasePolicy module" href="Policies.BasePolicy.html"/>
        <link rel="prev" title="Policies.ApproximatedFHGittins module" href="Policies.ApproximatedFHGittins.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SMPyBandits
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html"><em>SMPyBandits</em></a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">SMPyBandits modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Arms.html">Arms package</a></li>
<li class="toctree-l2"><a class="reference internal" href="Environment.html">Environment package</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="Policies.html">Policies package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Policies.html#Subpackages">Subpackages</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="Policies.html#Submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Policies.AdBandits.html">Policies.AdBandits module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.Aggregator.html">Policies.Aggregator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.ApproximatedFHGittins.html">Policies.ApproximatedFHGittins module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Policies.BESA module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.BasePolicy.html">Policies.BasePolicy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.BayesUCB.html">Policies.BayesUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.BayesianIndexPolicy.html">Policies.BayesianIndexPolicy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.BlackBoxOpt.html">Policies.BlackBoxOpt module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.BoltzmannGumbel.html">Policies.BoltzmannGumbel module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.CORRAL.html">Policies.CORRAL module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.CPUCB.html">Policies.CPUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.DMED.html">Policies.DMED module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.DiscountedUCB.html">Policies.DiscountedUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.DoublingTrickWrapper.html">Policies.DoublingTrickWrapper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.EmpiricalMeans.html">Policies.EmpiricalMeans module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.EpsilonDecreasing.html">Policies.EpsilonDecreasing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.EpsilonDecreasingMEGA.html">Policies.EpsilonDecreasingMEGA module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.EpsilonExpDecreasing.html">Policies.EpsilonExpDecreasing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.EpsilonFirst.html">Policies.EpsilonFirst module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.EpsilonGreedy.html">Policies.EpsilonGreedy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.Exp3.html">Policies.Exp3 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.Exp3PlusPlus.html">Policies.Exp3PlusPlus module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.ExploreThenCommit.html">Policies.ExploreThenCommit module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.Hedge.html">Policies.Hedge module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.IndexPolicy.html">Policies.IndexPolicy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.KLempUCB.html">Policies.KLempUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.LearnExp.html">Policies.LearnExp module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.MEGA.html">Policies.MEGA module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.MOSS.html">Policies.MOSS module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.MOSSAnytime.html">Policies.MOSSAnytime module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.MOSSExperimental.html">Policies.MOSSExperimental module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.MOSSH.html">Policies.MOSSH module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.MusicalChair.html">Policies.MusicalChair module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.OCUCB.html">Policies.OCUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.OSSB.html">Policies.OSSB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.ProbabilityPursuit.html">Policies.ProbabilityPursuit module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.SlidingWindowRestart.html">Policies.SlidingWindowRestart module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.SlidingWindowUCB.html">Policies.SlidingWindowUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.Softmax.html">Policies.Softmax module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.SparseUCB.html">Policies.SparseUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.SparseWrapper.html">Policies.SparseWrapper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.SparseklUCB.html">Policies.SparseklUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.TakeFixedArm.html">Policies.TakeFixedArm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.TakeRandomFixedArm.html">Policies.TakeRandomFixedArm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.Thompson.html">Policies.Thompson module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.ThompsonRobust.html">Policies.ThompsonRobust module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.TrekkingTSN.html">Policies.TrekkingTSN module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCB.html">Policies.UCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBH.html">Policies.UCBH module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBV.html">Policies.UCBV module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBVtuned.html">Policies.UCBVtuned module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBalpha.html">Policies.UCBalpha module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBcython.html">Policies.UCBcython module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBdagger.html">Policies.UCBdagger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBjulia.html">Policies.UCBjulia module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBlog10.html">Policies.UCBlog10 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBlog10alpha.html">Policies.UCBlog10alpha module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBmin.html">Policies.UCBmin module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBoost.html">Policies.UCBoost module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBoost_cython.html">Policies.UCBoost_cython module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBoost_faster.html">Policies.UCBoost_faster module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBoost_faster_cython.html">Policies.UCBoost_faster_cython module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBplus.html">Policies.UCBplus module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBrandomInit.html">Policies.UCBrandomInit module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UCBwrong.html">Policies.UCBwrong module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.Uniform.html">Policies.Uniform module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UniformOnSome.html">Policies.UniformOnSome module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.UnsupervisedLearning.html">Policies.UnsupervisedLearning module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.WrapRange.html">Policies.WrapRange module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCB.html">Policies.klUCB module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBH.html">Policies.klUCBH module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBHPlus.html">Policies.klUCBHPlus module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBPlus.html">Policies.klUCBPlus module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBPlusPlus.html">Policies.klUCBPlusPlus module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBlog10.html">Policies.klUCBlog10 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBloglog.html">Policies.klUCBloglog module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBloglog10.html">Policies.klUCBloglog10 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.klUCBswitch.html">Policies.klUCBswitch module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.kullback.html">Policies.kullback module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.kullback_cython.html">Policies.kullback_cython module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.setup.html">Policies.setup module</a></li>
<li class="toctree-l4"><a class="reference internal" href="Policies.usenumba.html">Policies.usenumba module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PoliciesMultiPlayers.html">PoliciesMultiPlayers package</a></li>
<li class="toctree-l2"><a class="reference internal" href="complete_tree_exploration_for_MP_bandits.html">complete_tree_exploration_for_MP_bandits module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">configuration module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_comparing_aggregation_algorithms.html">configuration_comparing_aggregation_algorithms module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_comparing_doubling_algorithms.html">configuration_comparing_doubling_algorithms module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_markovian.html">configuration_markovian module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_multiplayers.html">configuration_multiplayers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_sparse.html">configuration_sparse module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_sparse_multiplayers.html">configuration_sparse_multiplayers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="env_client.html">env_client module</a></li>
<li class="toctree-l2"><a class="reference internal" href="main.html">main module</a></li>
<li class="toctree-l2"><a class="reference internal" href="main_multiplayers.html">main_multiplayers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="main_multiplayers_more.html">main_multiplayers_more module</a></li>
<li class="toctree-l2"><a class="reference internal" href="main_sparse_multiplayers.html">main_sparse_multiplayers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="policy_server.html">policy_server module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../How_to_run_the_code.html">How to run the code ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PublicationsWithSMPyBandits.html">List of research publications using Lilian Besson&#8217;s SMPyBandits project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Aggregation.html"><strong>Policy aggregation algorithms</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../MultiPlayers.html"><strong>Multi-players simulation environment</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../DoublingTrick.html"><strong>Doubling Trick for Multi-Armed Bandits</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">Short documentation of the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TODO.html">💥 TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plots/README.html">Some illustrations for this project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/README.html">Jupyter Notebooks 📓 by Naereen &#64; GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/list.html">List of notebooks for SMPyBandits documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Profiling.html">A note on execution times, speed and profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uml_diagrams/README.html">UML diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logs/README.html"><code class="docutils literal"><span class="pre">logs/</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">On Github Issues and Pull Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Contributor Covenant Code of Conduct</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SMPyBandits</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">SMPyBandits modules</a> &raquo;</li>
        
          <li><a href="Policies.html">Policies package</a> &raquo;</li>
        
      <li>Policies.BESA module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/docs/Policies.BESA.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Policies.BESA-module">
<h1>Policies.BESA module<a class="headerlink" href="#Policies.BESA-module" title="Permalink to this headline">¶</a></h1>
<p>The Best Empirical Sampled Average (BESA) algorithm.</p>
<ul class="simple">
<li>Reference: [[Sub-Sampling For Multi Armed Bandits, Baransi et al., 2014]](<a class="reference external" href="https://hal.archives-ouvertes.fr/hal-01025651">https://hal.archives-ouvertes.fr/hal-01025651</a>)</li>
<li>See also: <a class="reference external" href="https://github.com/SMPyBandits/SMPyBandits/issues/103">https://github.com/SMPyBandits/SMPyBandits/issues/103</a> and <a class="reference external" href="https://github.com/SMPyBandits/SMPyBandits/issues/116">https://github.com/SMPyBandits/SMPyBandits/issues/116</a></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This algorithm works VERY well but it is looks weird at first sight. It sounds &#8220;too easy&#8221;, so take a look to the article before wondering why it should work.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Right now, it is between 10 and 25 times slower than <a class="reference internal" href="Policies.klUCB.html#module-Policies.klUCB" title="Policies.klUCB"><code class="xref py py-class docutils literal"><span class="pre">Policies.klUCB</span></code></a> and other single-player policies.</p>
</div>
<dl class="function">
<dt id="Policies.BESA.subsample_deterministic">
<code class="descclassname">Policies.BESA.</code><code class="descname">subsample_deterministic</code><span class="sig-paren">(</span><em>n</em>, <em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#subsample_deterministic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.subsample_deterministic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math">\(\{1,\dots,n\}\)</span> if <span class="math">\(n &lt; m\)</span> or <span class="math">\(\{1,\dots,m\}\)</span> if <span class="math">\(n \geq m\)</span> (<em>ie</em>, it is <span class="math">\(\{1,\dots,\min(n,m)\}\)</span>).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The BESA algorithm is efficient only with the random sub-sampling, don&#8217;t use this one except for comparing.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subsample_deterministic</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsample_deterministic</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  
<span class="go">array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.subsample_uniform">
<code class="descclassname">Policies.BESA.</code><code class="descname">subsample_uniform</code><span class="sig-paren">(</span><em>n</em>, <em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#subsample_uniform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.subsample_uniform" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a uniform sub-set of size <span class="math">\(n\)</span>, from <span class="math">\(\{1,dots, m\}\)</span>.</p>
<ul class="simple">
<li>Fails if n &gt; m.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The BESA algorithm is efficient only with the random sub-sampling.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  <span class="c1"># reproducible results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsample_uniform</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  
<span class="go">array([4, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsample_uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  
<span class="go">array([ 7, 16,  2,  3,  1, 18,  5,  4,  0,  8])</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt id="Policies.BESA.TOLERANCE">
<code class="descclassname">Policies.BESA.</code><code class="descname">TOLERANCE</code><em class="property"> = 1e-06</em><a class="headerlink" href="#Policies.BESA.TOLERANCE" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerical tolerance when comparing two means. Should not be zero!</p>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.inverse_permutation">
<code class="descclassname">Policies.BESA.</code><code class="descname">inverse_permutation</code><span class="sig-paren">(</span><em>permutation</em>, <em>j</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#inverse_permutation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.inverse_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse the permutation for given input j, that is, it finds i such that p[i] = j.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">permutation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverse_permutation</span><span class="p">(</span><span class="n">permutation</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverse_permutation</span><span class="p">(</span><span class="n">permutation</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.besa_two_actions">
<code class="descclassname">Policies.BESA.</code><code class="descname">besa_two_actions</code><span class="sig-paren">(</span><em>rewards</em>, <em>pulls</em>, <em>a</em>, <em>b</em>, <em>subsample_function=&lt;function subsample_uniform&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#besa_two_actions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.besa_two_actions" title="Permalink to this definition">¶</a></dt>
<dd><p>Core algorithm for the BESA selection, for two actions a and b:</p>
<ul class="simple">
<li>N = min(Na, Nb),</li>
<li>Sub-sample N values from rewards of arm a, and N values from rewards of arm b,</li>
<li>Compute mean of both samples of size N, call them m_a, m_b,</li>
<li>If m_a &gt; m_b, choose a,</li>
<li>Else if m_a &lt; m_b, choose b,</li>
<li>And in case of a tie, break by choosing i such that Ni is minimal (or random [a, b] if Na=Nb).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">rewards</span></code> can be a numpy array of shape (at least) <code class="docutils literal"><span class="pre">(nbArms,</span> <span class="pre">max(Na,</span> <span class="pre">Nb))</span></code> or a dictionary maping <code class="docutils literal"><span class="pre">a,b</span></code> to lists (or iterators) of lengths <code class="docutils literal"><span class="pre">&gt;=</span> <span class="pre">max(Na,</span> <span class="pre">Nb)</span></code>.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2345</span><span class="p">)</span>  <span class="c1"># reproducible results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">];</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulls</span><span class="p">);</span> <span class="n">N</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pulls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 1 is better  </span>
<span class="go">array([0.154..., 0.158...])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">[:,</span> <span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">pulls</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 0 is better in the first 6 samples  </span>
<span class="go">array([0.341..., 0.019...])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besa_two_actions</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_deterministic</span><span class="p">)</span>  
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">besa_two_actions</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_uniform</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  
<span class="go">[0, 0, 1, 1, 0, 0, 1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.besa_K_actions__non_randomized">
<code class="descclassname">Policies.BESA.</code><code class="descname">besa_K_actions__non_randomized</code><span class="sig-paren">(</span><em>rewards</em>, <em>pulls</em>, <em>left</em>, <em>right</em>, <em>subsample_function=&lt;function subsample_uniform&gt;</em>, <em>depth=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#besa_K_actions__non_randomized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.besa_K_actions__non_randomized" title="Permalink to this definition">¶</a></dt>
<dd><p>BESA recursive selection algorithm for an action set of size <span class="math">\(\mathcal{K} \geq 1\)</span>.</p>
<ul class="simple">
<li>I prefer to implement for a discrete action set <span class="math">\(\{\text{left}, \dots, \text{right}\}\)</span> (end <em>included</em>) instead of a generic <code class="docutils literal"><span class="pre">actions</span></code> vector, to speed up the code, but it is less readable.</li>
<li>The depth argument is just for pretty printing debugging information (useless).</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The binary tournament is NOT RANDOMIZED here, this version is only for testing.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  <span class="c1"># reproducible results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulls</span><span class="p">);</span> <span class="n">N</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pulls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 0 is better</span>
<span class="go">array([ 0.09876921, -0.18561207,  0.04463033,  0.0653539 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">[:,</span> <span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">pulls</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 1 is better in the first 6 samples</span>
<span class="go">array([-0.06401484,  0.17366346,  0.05323033, -0.09514708])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besa_K_actions__non_randomized</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_deterministic</span><span class="p">)</span>  
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">besa_K_actions__non_randomized</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_uniform</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  
<span class="go">[3, 3, 2, 3, 3, 0, 0, 0, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.besa_K_actions__smart_divideandconquer">
<code class="descclassname">Policies.BESA.</code><code class="descname">besa_K_actions__smart_divideandconquer</code><span class="sig-paren">(</span><em>rewards</em>, <em>pulls</em>, <em>left</em>, <em>right</em>, <em>random_permutation_of_arm=None</em>, <em>subsample_function=&lt;function subsample_uniform&gt;</em>, <em>depth=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#besa_K_actions__smart_divideandconquer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.besa_K_actions__smart_divideandconquer" title="Permalink to this definition">¶</a></dt>
<dd><p>BESA recursive selection algorithm for an action set of size <span class="math">\(\mathcal{K} \geq 1\)</span>.</p>
<ul class="simple">
<li>I prefer to implement for a discrete action set <span class="math">\(\{\text{left}, \dots, \text{right}\}\)</span> (end <em>included</em>) instead of a generic <code class="docutils literal"><span class="pre">actions</span></code> vector, to speed up the code, but it is less readable.</li>
<li>The depth argument is just for pretty printing debugging information (useless).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The binary tournament is RANDOMIZED here, as it should be.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  <span class="c1"># reproducible results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulls</span><span class="p">);</span> <span class="n">N</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pulls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 0 is better</span>
<span class="go">array([ 0.09876921, -0.18561207,  0.04463033,  0.0653539 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">[:,</span> <span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">pulls</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 1 is better in the first 6 samples</span>
<span class="go">array([-0.06401484,  0.17366346,  0.05323033, -0.09514708])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besa_K_actions__smart_divideandconquer</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_deterministic</span><span class="p">)</span>  
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">besa_K_actions__smart_divideandconquer</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_uniform</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  
<span class="go">[3, 3, 2, 3, 3, 0, 0, 0, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.besa_K_actions">
<code class="descclassname">Policies.BESA.</code><code class="descname">besa_K_actions</code><span class="sig-paren">(</span><em>rewards</em>, <em>pulls</em>, <em>actions</em>, <em>subsample_function=&lt;function subsample_uniform&gt;</em>, <em>depth=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#besa_K_actions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.besa_K_actions" title="Permalink to this definition">¶</a></dt>
<dd><p>BESA recursive selection algorithm for an action set of size <span class="math">\(\mathcal{K} \geq 1\)</span>.</p>
<ul class="simple">
<li>The divide and conquer is implemented for a generic list of actions, it&#8217;s slower but simpler to write! Left and right divisions are just <code class="docutils literal"><span class="pre">actions[:len(actions)//2]</span></code> and <code class="docutils literal"><span class="pre">actions[len(actions)//2:]</span></code>.</li>
<li>Actions is assumed to be shuffled <em>before</em> calling this function!</li>
<li>The depth argument is just for pretty printing debugging information (useless).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The binary tournament is RANDOMIZED here, <em>as it should be</em>.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  <span class="c1"># reproducible results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulls</span><span class="p">);</span> <span class="n">N</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pulls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 0 is better</span>
<span class="go">array([ 0.09876921, -0.18561207,  0.04463033,  0.0653539 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">[:,</span> <span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">pulls</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 1 is better in the first 6 samples</span>
<span class="go">array([-0.06401484,  0.17366346,  0.05323033, -0.09514708])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besa_K_actions</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_deterministic</span><span class="p">)</span>  
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">besa_K_actions</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_uniform</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  
<span class="go">[3, 3, 2, 3, 3, 0, 0, 0, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.besa_K_actions__non_binary">
<code class="descclassname">Policies.BESA.</code><code class="descname">besa_K_actions__non_binary</code><span class="sig-paren">(</span><em>rewards</em>, <em>pulls</em>, <em>actions</em>, <em>subsample_function=&lt;function subsample_uniform&gt;</em>, <em>depth=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#besa_K_actions__non_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.besa_K_actions__non_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>BESA recursive selection algorithm for an action set of size <span class="math">\(\mathcal{K} \geq 1\)</span>.</p>
<ul class="simple">
<li>Instead of doing this binary tree tournaments (which results in <span class="math">\(\mathcal{O}(K^2)\)</span> calls to the 2-arm procedure), we can do a line tournaments: 1 vs 2, winner vs 3, winner vs 4 etc, winner vs K-1 (which results in <span class="math">\(\mathcal{O}(K)\)</span> calls),</li>
<li>Actions is assumed to be shuffled <em>before</em> calling this function!</li>
<li>The depth argument is just for pretty printing debugging information (useless).</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  <span class="c1"># reproducible results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulls</span><span class="p">);</span> <span class="n">N</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pulls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 0 is better</span>
<span class="go">array([ 0.09876921, -0.18561207,  0.04463033,  0.0653539 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">[:,</span> <span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">pulls</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 1 is better in the first 6 samples</span>
<span class="go">array([-0.06401484,  0.17366346,  0.05323033, -0.09514708])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besa_K_actions__non_binary</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_deterministic</span><span class="p">)</span>  
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">besa_K_actions__non_binary</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_uniform</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  
<span class="go">[3, 3, 3, 2, 0, 3, 3, 3, 3, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="Policies.BESA.besa_K_actions__non_recursive">
<code class="descclassname">Policies.BESA.</code><code class="descname">besa_K_actions__non_recursive</code><span class="sig-paren">(</span><em>rewards</em>, <em>pulls</em>, <em>subsample_function=&lt;function subsample_uniform&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#besa_K_actions__non_recursive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.besa_K_actions__non_recursive" title="Permalink to this definition">¶</a></dt>
<dd><p>BESA non-recursive selection algorithm for an action set of size <span class="math">\(\mathcal{K} \geq 1\)</span>.</p>
<ul class="simple">
<li>No calls to <a class="reference internal" href="#Policies.BESA.besa_two_actions" title="Policies.BESA.besa_two_actions"><code class="xref py py-func docutils literal"><span class="pre">besa_two_actions()</span></code></a>, just generalize it to K actions instead of 2.</li>
<li>Actions is assumed to be shuffled <em>before</em> calling this function!</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  <span class="c1"># reproducible results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulls</span><span class="p">);</span> <span class="n">N</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pulls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 0 is better</span>
<span class="go">array([ 0.09876921, -0.18561207,  0.04463033,  0.0653539 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rewards</span><span class="p">[:,</span> <span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">pulls</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># arm 1 is better in the first 6 samples</span>
<span class="go">array([-0.06401484,  0.17366346,  0.05323033, -0.09514708])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besa_K_actions__non_recursive</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_deterministic</span><span class="p">)</span>  
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">besa_K_actions__non_recursive</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">pulls</span><span class="p">,</span> <span class="n">subsample_function</span><span class="o">=</span><span class="n">subsample_uniform</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  
<span class="go">[1, 3, 0, 2, 2, 3, 1, 1, 3, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="Policies.BESA.BESA">
<em class="property">class </em><code class="descclassname">Policies.BESA.</code><code class="descname">BESA</code><span class="sig-paren">(</span><em>nbArms</em>, <em>horizon=None</em>, <em>minPullsOfEachArm=1</em>, <em>randomized_tournament=True</em>, <em>random_subsample=True</em>, <em>non_binary=False</em>, <em>non_recursive=False</em>, <em>lower=0.0</em>, <em>amplitude=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Policies.IndexPolicy.html#Policies.IndexPolicy.IndexPolicy" title="Policies.IndexPolicy.IndexPolicy"><code class="xref py py-class docutils literal"><span class="pre">Policies.IndexPolicy.IndexPolicy</span></code></a></p>
<p>The Best Empirical Sampled Average (BESA) algorithm.</p>
<ul class="simple">
<li>Reference: [[Sub-Sampling For Multi Armed Bandits, Baransi et al., 2014]](<a class="reference external" href="https://arxiv.org/abs/1711.00400">https://arxiv.org/abs/1711.00400</a>)</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The BESA algorithm requires to store all the history of rewards, so its memory usage for <span class="math">\(T\)</span> rounds with <span class="math">\(K\)</span> arms is <span class="math">\(\mathcal{O}(K T)\)</span>, which is huge for large <span class="math">\(T\)</span>, be careful! Aggregating different BESA instances is probably a bad idea because of this limitation!</p>
</div>
<dl class="method">
<dt id="Policies.BESA.BESA.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>nbArms</em>, <em>horizon=None</em>, <em>minPullsOfEachArm=1</em>, <em>randomized_tournament=True</em>, <em>random_subsample=True</em>, <em>non_binary=False</em>, <em>non_recursive=False</em>, <em>lower=0.0</em>, <em>amplitude=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.horizon">
<code class="descname">horizon</code><em class="property"> = None</em><a class="headerlink" href="#Policies.BESA.BESA.horizon" title="Permalink to this definition">¶</a></dt>
<dd><p>Just to know the memory to allocate for rewards. It could be implemented without knowing the horizon, by using lists to keep all the reward history, but this would be way slower!</p>
</dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.minPullsOfEachArm">
<code class="descname">minPullsOfEachArm</code><em class="property"> = None</em><a class="headerlink" href="#Policies.BESA.BESA.minPullsOfEachArm" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum number of pulls of each arm before using the BESA algorithm. Using 1 might not be the best choice</p>
</dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.randomized_tournament">
<code class="descname">randomized_tournament</code><em class="property"> = None</em><a class="headerlink" href="#Policies.BESA.BESA.randomized_tournament" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to use a deterministic or random tournament.</p>
</dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.random_subsample">
<code class="descname">random_subsample</code><em class="property"> = None</em><a class="headerlink" href="#Policies.BESA.BESA.random_subsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to use a deterministic or random sub-sampling procedure.</p>
</dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.non_binary">
<code class="descname">non_binary</code><em class="property"> = None</em><a class="headerlink" href="#Policies.BESA.BESA.non_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to use <a class="reference internal" href="#Policies.BESA.besa_K_actions" title="Policies.BESA.besa_K_actions"><code class="xref py py-func docutils literal"><span class="pre">besa_K_actions()</span></code></a> or <a class="reference internal" href="#Policies.BESA.besa_K_actions__non_binary" title="Policies.BESA.besa_K_actions__non_binary"><code class="xref py py-func docutils literal"><span class="pre">besa_K_actions__non_binary()</span></code></a> for the selection of K arms.</p>
</dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.non_recursive">
<code class="descname">non_recursive</code><em class="property"> = None</em><a class="headerlink" href="#Policies.BESA.BESA.non_recursive" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to use <a class="reference internal" href="#Policies.BESA.besa_K_actions" title="Policies.BESA.besa_K_actions"><code class="xref py py-func docutils literal"><span class="pre">besa_K_actions()</span></code></a> or <a class="reference internal" href="#Policies.BESA.besa_K_actions__non_recursive" title="Policies.BESA.besa_K_actions__non_recursive"><code class="xref py py-func docutils literal"><span class="pre">besa_K_actions__non_recursive()</span></code></a> for the selection of K arms.</p>
</dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.all_rewards">
<code class="descname">all_rewards</code><em class="property"> = None</em><a class="headerlink" href="#Policies.BESA.BESA.all_rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>Keep <strong>all</strong> rewards of each arms. It consumes a <span class="math">\(\mathcal{O}(K T)\)</span> memory, that&#8217;s really bad!!</p>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.__str__">
<code class="descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.__str__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>-&gt; str</p>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.getReward">
<code class="descname">getReward</code><span class="sig-paren">(</span><em>arm</em>, <em>reward</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.getReward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.getReward" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the current reward in the global history.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is no need to normalize the reward in [0,1], that&#8217;s one of the strong point of the BESA algorithm.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.choice">
<code class="descname">choice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.choice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.choice" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the BESA procedure with the current data history.</p>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.choiceFromSubSet">
<code class="descname">choiceFromSubSet</code><span class="sig-paren">(</span><em>availableArms='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.choiceFromSubSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.choiceFromSubSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the BESA procedure with the current data history, to the restricted set of arm.</p>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.choiceMultiple">
<code class="descname">choiceMultiple</code><span class="sig-paren">(</span><em>nb=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.choiceMultiple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.choiceMultiple" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the multiple-choice BESA procedure with the current data history:</p>
<ol class="arabic simple">
<li>select a first arm with basic BESA procedure with full action set,</li>
<li>remove it from the set of actions,</li>
<li>restart step 1 with new smaller set of actions, until <code class="docutils literal"><span class="pre">nb</span></code> arm where chosen by basic BESA.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This was not studied or published before, and there is no theoretical results about it!</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is very inefficient! The BESA procedure is already quite slow (with my current naive implementation), this is crazily slow!</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.choiceWithRank">
<code class="descname">choiceWithRank</code><span class="sig-paren">(</span><em>rank=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.choiceWithRank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.choiceWithRank" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the ranked BESA procedure with the current data history:</p>
<ol class="arabic simple">
<li>use <code class="xref py py-meth docutils literal"><span class="pre">choiceMultiplie()</span></code> to select <code class="docutils literal"><span class="pre">rank</span></code> actions,</li>
<li>then take the <code class="docutils literal"><span class="pre">rank</span></code>-th chosen action (the last one).</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This was not studied or published before, and there is no theoretical results about it!</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is very inefficient! The BESA procedure is already quite slow (with my current naive implementation), this is crazily slow!</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.computeIndex">
<code class="descname">computeIndex</code><span class="sig-paren">(</span><em>arm</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.computeIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.computeIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the current index of arm &#8216;arm&#8217;.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This index <strong>is not</strong> the one used for the choice of arm (which use sub sampling). It&#8217;s just the empirical mean of the arm.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.computeAllIndex">
<code class="descname">computeAllIndex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.computeAllIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.computeAllIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the current index of arm &#8216;arm&#8217; (vectorized).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This index <strong>is not</strong> the one used for the choice of arm (which use sub sampling). It&#8217;s just the empirical mean of the arm.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Policies.BESA.BESA.__module__">
<code class="descname">__module__</code><em class="property"> = 'Policies.BESA'</em><a class="headerlink" href="#Policies.BESA.BESA.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="Policies.BESA.BESA.handleCollision">
<code class="descname">handleCollision</code><span class="sig-paren">(</span><em>arm</em>, <em>reward=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Policies/BESA.html#BESA.handleCollision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Policies.BESA.BESA.handleCollision" title="Permalink to this definition">¶</a></dt>
<dd><p>Nothing special to do.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Policies.BasePolicy.html" class="btn btn-neutral float-right" title="Policies.BasePolicy module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Policies.ApproximatedFHGittins.html" class="btn btn-neutral" title="Policies.ApproximatedFHGittins module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Lilian Besson (Naereen).
      Last updated on 16 May 2018, 16h.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.9.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>